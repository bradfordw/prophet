<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OCILIB (C Driver for Oracle): OCILIB main demo application code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OCILIB (C Driver for Oracle)&#160;<span id="projectnumber">3.9.3</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">OCILIB main demo application code</div>  </div>
</div>
<div class="contents">
<p>Portable Main demo application header </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                     OCILIB - C Driver for Oracle                     |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                      (C Wrapper for Oracle OCI)                      |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                         DEMO HEADER FILE                             |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |                      Website : http://www.ocilib.net                 |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |               Copyright (c) 2007-2010 Vincent ROGIER                 |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   | This library is free software; you can redistribute it and/or        |</span>
<span class="comment">   | modify it under the terms of the GNU Lesser General Public           |</span>
<span class="comment">   | License as published by the Free Software Foundation; either         |</span>
<span class="comment">   | version 2 of the License, or (at your option) any later version.     |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   | This library is distributed in the hope that it will be useful,      |</span>
<span class="comment">   | but WITHOUT ANY WARRANTY; without even the implied warranty of       |</span>
<span class="comment">   | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU    |</span>
<span class="comment">   | Lesser General Public License for more details.                      |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   | You should have received a copy of the GNU Lesser General Public     |</span>
<span class="comment">   | License along with this library; if not, write to the Free           |</span>
<span class="comment">   | Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.   |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |          Author: Vincent ROGIER &lt;vince.rogier@gmail.com&gt;             |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">*/</span>

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> *</span>
<span class="comment"> * THIS DEMO RUNS ON ALL PLATFOMS AND OCILIB BUILDS.</span>
<span class="comment"> *</span>
<span class="comment"> * SO, WE NEED A LITTLE EFFORT TO KEEP THE SAME SOURCE CODE FOR :</span>
<span class="comment"> *</span>
<span class="comment"> *    - MS WINDOWS AND UNIXES</span>
<span class="comment"> *    - ANSI / MIXED / WIDE BUILDS</span>
<span class="comment"> *</span>
<span class="comment"> * SOME DEFINES FOLLOW IN ORDER TO HANDLE ALL THOSE STUFF</span>
<span class="comment"> *</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * COMMON DEFINES</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#define ARG_DB     1</span>
<span class="preprocessor"></span><span class="preprocessor">#define ARG_USER   2</span>
<span class="preprocessor"></span><span class="preprocessor">#define ARG_PWD    3</span>
<span class="preprocessor"></span><span class="preprocessor">#define ARG_HOME   4</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define ARG_COUNT  5</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define SIZE_STR   260</span>
<span class="preprocessor"></span><span class="preprocessor">#define SIZE_BUF   2048</span>
<span class="preprocessor"></span><span class="preprocessor">#define SIZE_TAB   5</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define SIZE_ARRAY 100</span>
<span class="preprocessor"></span><span class="preprocessor">#define NB_LOAD    10</span>
<span class="preprocessor"></span><span class="preprocessor">#define SIZE_COL1  20</span>
<span class="preprocessor"></span><span class="preprocessor">#define SIZE_COL2  30</span>
<span class="preprocessor"></span><span class="preprocessor">#define SIZE_COL3  8</span>
<span class="preprocessor"></span><span class="preprocessor">#define NUM_COLS   3</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define ARRAY_COUNT(t) (sizeof(t)/sizeof(t[0]))</span>
<span class="preprocessor"></span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>test_t
{
        void (*proc)(void); <span class="comment">/* test procedure */</span>
        <span class="keywordtype">int</span>    execute;     <span class="comment">/* do execute the procedure ? */</span>
}test_t;

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * PlATFORMS</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#ifdef _WINDOWS</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #include &quot;windows.h&quot;</span>

<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * INCLUDES</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#include &quot;ocilib.h&quot;</span>

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * PLATFORMS</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#ifdef _MSC_VER</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #if defined(OCI_CHARSET_WIDE)</span>
<span class="preprocessor"></span><span class="preprocessor">      #pragma comment(lib, &quot;ocilibw.lib&quot;)</span>
<span class="preprocessor"></span><span class="preprocessor">  #elif defined(OCI_CHARSET_MIXED)</span>
<span class="preprocessor"></span><span class="preprocessor">      #pragma comment(lib, &quot;ocilibm.lib&quot;)</span>
<span class="preprocessor"></span><span class="preprocessor">  #elif defined(OCI_CHARSET_ANSI)</span>
<span class="preprocessor"></span><span class="preprocessor">      #pragma comment(lib, &quot;ociliba.lib&quot;)</span>
<span class="preprocessor"></span><span class="preprocessor">  #endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifdef _WINDOWS</span>
<span class="preprocessor"></span><span class="preprocessor">   #define EXE_NAME   &quot;ocilib_demo.exe&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">   #define EXE_NAME   &quot;ocilib_demo&quot;</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * STRING PRINTING</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#define print_text(x)       printf(x)</span>
<span class="preprocessor"></span><span class="preprocessor">#define print_frmt(f, x)    printf(f, x)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#if defined(OCI_CHARSET_WIDE)</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_mt  wprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define print_dt  wprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_mt swprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_dt swprintf</span>
<span class="preprocessor"></span>
<span class="preprocessor">#elif defined(OCI_CHARSET_MIXED)</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_mt  printf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define print_dt  wprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_mt ocisprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_dt swprintf</span>
<span class="preprocessor"></span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_mt  printf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define print_dt  printf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_mt ocisprintf</span>
<span class="preprocessor"></span><span class="preprocessor">  #define sprint_dt ocisprintf</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">/* print userdata text */</span>

<span class="preprocessor">#if !defined(OCI_CHARSET_ANSI) &amp;&amp; !defined(_WINDOWS)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define print_dstr(x)   printf(&quot;%ls&quot;, (wchar_t*) x)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_dstr(x)   print_dt(DT(&quot;%s&quot;), x)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">/* print metadata text */</span>

<span class="preprocessor">#if defined(OCI_CHARSET_WIDE) &amp;&amp; !defined(_WINDOWS)</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_mstr(x)   printf(&quot;%ls&quot;, x)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define print_mstr(x)   print_mt(MT(&quot;%s&quot;), x)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * PROGRAM ARGUMENTS</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="preprocessor">#if defined(OCI_CHARSET_WIDE)</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #if defined(_MSC_VER)</span>
<span class="preprocessor"></span>
<span class="preprocessor">    #define mtmain          wmain</span>
<span class="preprocessor"></span><span class="preprocessor">    #define mtarg           mtext</span>
<span class="preprocessor"></span><span class="preprocessor">    #define print_args(x)   print_mt(x)</span>
<span class="preprocessor"></span><span class="preprocessor">    #define GET_ARG(s, i)   mtsncat(s, argv[i], sizeof(s))</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #else</span>
<span class="preprocessor"></span>
<span class="preprocessor">    #define mtmain          main</span>
<span class="preprocessor"></span><span class="preprocessor">    #define mtarg           char</span>
<span class="preprocessor"></span><span class="preprocessor">    #define print_args(x)   print_mstr(x)</span>
<span class="preprocessor"></span><span class="preprocessor">    #define GET_ARG(s, i)   mbstowcs(s, argv[i], sizeof(s))</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define mtmain          main</span>
<span class="preprocessor"></span><span class="preprocessor">  #define mtarg           char</span>
<span class="preprocessor"></span><span class="preprocessor">  #define print_args(x)   print_text(x)</span>
<span class="preprocessor"></span><span class="preprocessor">  #define GET_ARG(s, i)   strncat(s, argv[i], sizeof(s))</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

</pre></div><p>Portable Main demo application source </p>
<div class="fragment"><pre class="fragment"><span class="comment">/*</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                     OCILIB - C Driver for Oracle                     |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                      (C Wrapper for Oracle OCI)                      |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   |                         DEMO SOURCE FILE                             |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |                      Website : http://ocilib.net                     |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |               Copyright (c) 2007-2010 Vincent ROGIER                 |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   | This library is free software; you can redistribute it and/or        |</span>
<span class="comment">   | modify it under the terms of the GNU Lesser General Public           |</span>
<span class="comment">   | License as published by the Free Software Foundation; either         |</span>
<span class="comment">   | version 2 of the License, or (at your option) any later version.     |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   | This library is distributed in the hope that it will be useful,      |</span>
<span class="comment">   | but WITHOUT ANY WARRANTY; without even the implied warranty of       |</span>
<span class="comment">   | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU    |</span>
<span class="comment">   | Lesser General Public License for more details.                      |</span>
<span class="comment">   |                                                                      |</span>
<span class="comment">   | You should have received a copy of the GNU Lesser General Public     |</span>
<span class="comment">   | License along with this library; if not, write to the Free           |</span>
<span class="comment">   | Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.   |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">   |          Author: Vincent ROGIER &lt;vince.rogier@gmail.com&gt;             |</span>
<span class="comment">   +----------------------------------------------------------------------+</span>
<span class="comment">*/</span>

<span class="preprocessor">#include &quot;ocilib_demo.h&quot;</span>

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * prototypes</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> err_handler(<a class="code" href="struct_o_c_i___error.html" title="Encapsulates an Oracle or OCILIB exception.">OCI_Error</a> *err);
<span class="keywordtype">void</span> print_version(<span class="keywordtype">void</span>);

<span class="keywordtype">void</span> cleanup(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> disconnect(<span class="keywordtype">void</span>);

<span class="keywordtype">void</span> create_tables(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> drop_tables(<span class="keywordtype">void</span>);

<span class="keywordtype">void</span> test_format(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_immediate(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_immediate_format(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_fetch(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_bind1(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_bind2(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_piecewise_insert(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_piecewise_fetch(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_lob(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_nested_table(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_ref_cursor(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_plsql(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_dates(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_timestamp(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_describe(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_returning(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_returning_array(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_object_insert(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_object_fetch(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_scrollable_cursor(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_collection(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_ref(<span class="keywordtype">void</span>);
<span class="keywordtype">void</span> test_directpath(<span class="keywordtype">void</span>);


<span class="comment">/* ocilib test functions array */</span>

test_t tab_test[] =
{
        {test_format,            TRUE},
        {test_immediate,         TRUE},
        {test_immediate_format,  TRUE},
        {test_fetch,             TRUE},
        {test_bind1,             TRUE},
        {test_bind2,             TRUE},
        {test_piecewise_insert,  TRUE},
        {test_piecewise_fetch,   TRUE},
        {test_lob,               TRUE},
        {test_nested_table,      TRUE},
        {test_ref_cursor,        TRUE},
        {test_plsql,             TRUE},
        {test_dates,             TRUE},
        {test_timestamp,         TRUE},
        {test_describe,          TRUE},
        {test_returning,         TRUE},
        {test_returning_array,   TRUE},
        {test_object_insert,     TRUE},
        {test_object_fetch,      TRUE},
        {test_scrollable_cursor, TRUE},
        {test_collection,        TRUE},
        {test_ref,               TRUE},
        {test_directpath,        TRUE}
};

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * variables</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keyword">static</span> <a class="code" href="struct_o_c_i___connection.html" title="Oracle physical connection.">OCI_Connection</a> *cn = NULL;
<span class="keyword">static</span> <a class="code" href="struct_o_c_i___statement.html" title="Oracle SQL or PL/SQL statement.">OCI_Statement</a>  *st = NULL;
<span class="keyword">static</span> <a class="code" href="struct_o_c_i___resultset.html" title="Collection of output columns from a select statement.">OCI_Resultset</a>  *rs = NULL;

<span class="keyword">static</span> mtext str[SIZE_STR+1];
<span class="keyword">static</span> dtext temp[SIZE_STR+1];

<span class="keyword">static</span> <span class="keywordtype">int</span> nb_err  = 0;
<span class="keyword">static</span> <span class="keywordtype">int</span> nb_warn = 0;

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * err_handler</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> err_handler(<a class="code" href="struct_o_c_i___error.html" title="Encapsulates an Oracle or OCILIB exception.">OCI_Error</a> *err)
{
    <span class="keywordtype">int</span> err_type = <a class="code" href="group__g__error.html#ga66d447c8cd06ea3f841b439a1aac055b" title="Retrieve the type of error from error handle.">OCI_ErrorGetType</a>(err);

    print_text(<span class="stringliteral">&quot;\n&quot;</span>);

    <span class="keywordflow">if</span> (err_type == OCI_ERR_WARNING)
    {
         print_text(<span class="stringliteral">&quot;&gt; WARNING : &quot;</span>);
         nb_warn++;
    }
    <span class="keywordflow">else</span>
    {
        print_text(<span class="stringliteral">&quot;&gt; ERROR   : &quot;</span>);
        nb_err++;
    }

    print_mstr(<a class="code" href="group__g__error.html#gaa06418c61c432aaaa725fecdd28bcb96" title="Retrieve error message from error handle.">OCI_ErrorGetString</a>(err));
    print_text(<span class="stringliteral">&quot;\n&quot;</span>);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * main</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">int</span> mtmain(<span class="keywordtype">int</span> argc, mtarg* argv[])
{
    mtext home[SIZE_STR+1] = MT(<span class="stringliteral">&quot;&quot;</span>);
    mtext dbs [SIZE_STR+1] = MT(<span class="stringliteral">&quot;&quot;</span>);
    mtext usr [SIZE_STR+1] = MT(<span class="stringliteral">&quot;&quot;</span>);
    mtext pwd [SIZE_STR+1] = MT(<span class="stringliteral">&quot;&quot;</span>);

    <span class="keywordtype">size_t</span> i;

    <span class="comment">/* CHECK COMMAND LINE --------------------------------------------------- */</span>

    <span class="keywordflow">if</span> (argc &lt; (ARG_COUNT-1))
    {
        <span class="keywordflow">return</span> EXIT_FAILURE;
    }

    <span class="comment">/* GET ARGUMENTS ---------------------------------------------------------*/</span>

    GET_ARG(dbs, ARG_DB);
    GET_ARG(usr, ARG_USER);
    GET_ARG(pwd, ARG_PWD);

    <span class="keywordflow">if</span>(argc == ARG_COUNT)
        GET_ARG(home, ARG_HOME);

    <span class="comment">/* INITIALIZE OCI ------------------------------------------------------- */</span>

    <span class="keywordflow">if</span> (!<a class="code" href="group__g__init.html#ga5477d70fd14cf997390271aa748a1c0e" title="Initialize the library.">OCI_Initialize</a>(err_handler, home, OCI_ENV_DEFAULT))
        <span class="keywordflow">return</span> EXIT_FAILURE;

    <a class="code" href="group__g__init.html#gad1d661302df3dd8979296dfaad3593be" title="Enable or disable Oracle warning notifications.">OCI_EnableWarnings</a>(TRUE);

    <span class="comment">/* CONNECTION TO SERVER ------------------------------------------------- */</span>

    print_text(<span class="stringliteral">&quot;Connecting to &quot;</span>);
    print_args(usr);
    print_text(<span class="stringliteral">&quot;/&quot;</span>);
    print_args(pwd);
    print_text(<span class="stringliteral">&quot;@&quot;</span>);
    print_args(dbs);
    print_text(<span class="stringliteral">&quot;\n\n&quot;</span>);

    cn = <a class="code" href="group__g__connect.html#gadb6e2cdf759587dd81c2fda7c5f44338" title="Create a physical connection to an Oracle database server.">OCI_ConnectionCreate</a>(dbs, usr, pwd, OCI_SESSION_DEFAULT);

    <span class="keywordflow">if</span> (cn)
    {
        st = <a class="code" href="group__g__exec.html#ga335822f983af0fb5c529431f06a9a17b" title="Create a statement object and return its handle.">OCI_StatementCreate</a>(cn);

        print_version();
        create_tables();

        <span class="comment">/* execute tests */</span>

        <span class="keywordflow">for</span> (i = 0; i &lt; ARRAY_COUNT(tab_test); i++)
        {
            <span class="keywordflow">if</span> (tab_test[i].execute)
                tab_test[i].proc();
        }

        drop_tables();

        disconnect();
    }
    <span class="keywordflow">else</span>
    {
        print_mstr(<a class="code" href="group__g__error.html#gaa06418c61c432aaaa725fecdd28bcb96" title="Retrieve error message from error handle.">OCI_ErrorGetString</a>(<a class="code" href="group__g__error.html#gaf2abe52ad5b278f65dd97a44a2adac4c" title="Retrieve the last error occurred within the last OCILIB call.">OCI_GetLastError</a>()));
    }

    cleanup();

    print_text(<span class="stringliteral">&quot;\npress any key to exit...&quot;</span>);

    getchar();

    <span class="keywordflow">return</span> EXIT_SUCCESS;
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * cleanup</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> cleanup(<span class="keywordtype">void</span>)
{
    <a class="code" href="group__g__init.html#ga639706aa8e9689c7ebffc018fac6d3ae" title="Clean up all resources allocated by the library.">OCI_Cleanup</a>();

    print_frmt(<span class="stringliteral">&quot;\n%i errors   \n&quot;</span>, nb_err);
    print_frmt(<span class="stringliteral">&quot;\n%i warnings \n\n&quot;</span>, nb_warn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * disconnect</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> disconnect(<span class="keywordtype">void</span>)
{
    <a class="code" href="group__g__connect.html#gac3fe655e96074adb119908be4650a4c9" title="Close a physical connection to an Oracle database server.">OCI_ConnectionFree</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * print_version</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> print_version(<span class="keywordtype">void</span>)
{
    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; OCILIB BUILD INFORMATION \n\n&quot;</span>);

    <span class="keywordflow">if</span> (<a class="code" href="group__g__init.html#gaecbebbd3747c5012dfbf072f90e33c77" title="Return the Oracle shared library import mode.">OCI_GetImportMode</a>() == OCI_IMPORT_MODE_LINKAGE)
        print_text(<span class="stringliteral">&quot;OCI import mode         : LINKAGE\n&quot;</span>);
    <span class="keywordflow">else</span>
        print_text(<span class="stringliteral">&quot;OCI import mode         : RUNTIME\n&quot;</span>);

    <span class="keywordflow">if</span> (<a class="code" href="group__g__init.html#gab6f4587e77cfa0f0696f1a676080b9d7" title="Return the metadata charset type.">OCI_GetCharsetMetaData</a>() == OCI_CHAR_ANSI)
        print_text(<span class="stringliteral">&quot;MetaData  char type     : ANSI\n&quot;</span>);
    <span class="keywordflow">else</span>
        print_text(<span class="stringliteral">&quot;MetaData  char type     : WIDE\n&quot;</span>);

    <span class="keywordflow">if</span> (<a class="code" href="group__g__init.html#gae4f4cbad741ad0c35d9470708a3a0f15" title="Return the user data charset type.">OCI_GetCharsetUserData</a>() == OCI_CHAR_ANSI)
        print_text(<span class="stringliteral">&quot;UserData  char type     : ANSI\n&quot;</span>);
    <span class="keywordflow">else</span>
        print_text(<span class="stringliteral">&quot;UserData  char type     : WIDE\n&quot;</span>);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; VERSIONS INFORMATION \n\n&quot;</span>);

    print_frmt(<span class="stringliteral">&quot;OCILIB major    version : %i\n&quot;</span>,   OCILIB_MAJOR_VERSION);
    print_frmt(<span class="stringliteral">&quot;OCILIB minor    version : %i\n&quot;</span>,   OCILIB_MINOR_VERSION);
    print_frmt(<span class="stringliteral">&quot;OCILIB revision version : %i\n\n&quot;</span>, OCILIB_REVISION_VERSION);

    <span class="comment">/* print all versions */</span>
    print_frmt(<span class="stringliteral">&quot;OCI compile     version : %i\n&quot;</span>,   OCI_VER_MAJ(<a class="code" href="group__g__init.html#ga6fa5693d691752f93dbc6baf07e6cceb" title="Return the version of OCI used for compilation.">OCI_GetOCICompileVersion</a>()));
    print_frmt(<span class="stringliteral">&quot;OCI runtime     version : %i\n\n&quot;</span>, OCI_VER_MAJ(<a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>()));

    print_frmt(<span class="stringliteral">&quot;Server major    version : %i\n&quot;</span>,   <a class="code" href="group__g__connect.html#ga2d7618d8eae73643dd75067a40e656a1" title="Return the major version number of the connected database server.">OCI_GetServerMajorVersion</a>(cn));
    print_frmt(<span class="stringliteral">&quot;Server minor    version : %i\n&quot;</span>,   <a class="code" href="group__g__connect.html#ga8f48a3c755751e5df415160913c6c7ee" title="Return the minor version number of the connected database server.">OCI_GetServerMinorVersion</a>(cn));
    print_frmt(<span class="stringliteral">&quot;Server revision version : %i\n\n&quot;</span>, <a class="code" href="group__g__connect.html#gae4c3b37f1c9fc79d36220aa9c96d4415" title="Return the revision version number of the connected database server.">OCI_GetServerRevisionVersion</a>(cn));

    print_frmt(<span class="stringliteral">&quot;Connection      version : %i\n\n&quot;</span>, <a class="code" href="group__g__connect.html#ga6f61147801fce4b69edb4981ba4ea1b7" title="Return the highest Oracle version is supported by the connection.">OCI_GetVersionConnection</a>(cn));

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; SERVER VERSION BANNER \n\n&quot;</span>);

    <span class="comment">/* print server string version */</span>

    print_mstr(<a class="code" href="group__g__connect.html#gaed47a25a1f96fd630f176fe702ac443a" title="Return the connected database server version.">OCI_GetVersionServer</a>(cn));

    print_text(<span class="stringliteral">&quot;\n\n&quot;</span>);

}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * create_tables</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> create_tables(<span class="keywordtype">void</span>)
{
    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; CREATE TABLES FOR DEMO \n\n&quot;</span>);

    <span class="comment">/* create types for the demo */</span>
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create type type_t as OBJECT (id int, name varchar2(50))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create type test_t as object &quot;</span>)
                    MT(<span class="stringliteral">&quot;( &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_int  number, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_flt  float, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_str  varchar2(30), &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_date date, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_lob  clob, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_file bfile, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_obj  type_t, &quot;</span>)
                    MT(<span class="stringliteral">&quot;    val_raw  raw(10) &quot;</span>)
                    MT(<span class="stringliteral">&quot;)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create type t_tab1_emp as VARRAY(100) of varchar2(50)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create type t_tab2_emp as table of varchar2(50)&quot;</span>));

    <span class="comment">/* create table for the demo */</span>
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_fetch(code int, article &quot;</span>)
                        MT(<span class="stringliteral">&quot;varchar2(30), price float, creation date)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_long_raw(code int, content long raw)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_long_str(code int, content long)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_lob(code int, content clob)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_object(val test_t)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_table_obj of type_t&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_array &quot;</span>)
                        MT(<span class="stringliteral">&quot;( &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_int  number, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_flt  float, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_str  varchar2(30), &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_date date, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_lob  clob, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    val_file bfile &quot;</span>)
                        MT(<span class="stringliteral">&quot;)&quot;</span>)
                    );

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_coll_varray &quot;</span>)
                        MT(<span class="stringliteral">&quot;( &quot;</span>)
                        MT(<span class="stringliteral">&quot;    departement number, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    employees   t_tab1_emp &quot;</span>)
                        MT(<span class="stringliteral">&quot;)&quot;</span>)
                    );

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_coll_nested &quot;</span>)
                        MT(<span class="stringliteral">&quot;( &quot;</span>)
                        MT(<span class="stringliteral">&quot;    departement number, &quot;</span>)
                        MT(<span class="stringliteral">&quot;    employees   t_tab2_emp &quot;</span>)
                        MT(<span class="stringliteral">&quot;) nested table employees store as test_table_emp&quot;</span>)
                    );

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;create table test_directpath(val_int number(8,4), &quot;</span>)
                        MT(<span class="stringliteral">&quot; val_str varchar2(30), val_date date)&quot;</span>));

    <span class="comment">/* insert data into the demo tables */</span>
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_fetch &quot;</span>)
                        MT(<span class="stringliteral">&quot;(code, article, price, creation) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (1, &#39;shoes&#39;, 3.14, to_date(&#39;1978-12-23&#39;, &#39;YYYY-MM-DD&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_fetch &quot;</span>)
                        MT(<span class="stringliteral">&quot;(code, article, price, creation) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (2, &#39;shirt&#39;, 5.99, to_date(&#39;1999-09-12&#39;, &#39;YYYY-MM-DD&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_lob(code,content)  &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (1, EMPTY_CLOB())&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_long_str(code,content) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (1, &#39;Rugby rocks !&#39;)&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_coll_varray(departement,employees) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (1, t_tab1_emp(&#39;Peter&#39;, &#39;John&#39;, &#39;Paula&#39;, &#39;Gina&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_coll_varray(departement,employees) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (2, t_tab1_emp(&#39;Ben&#39;, &#39;Alice&#39;, &#39;Joel&#39;, &#39;Maria&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_coll_nested(departement,employees) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (1, t_tab2_emp(&#39;Vince&#39;, &#39;Richard&#39;, &#39;Rita&#39;, &#39;Sophia&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_coll_nested(departement,employees) &quot;</span>)
                        MT(<span class="stringliteral">&quot;values (2, t_tab2_emp(&#39;Paul&#39;, &#39;Sarah&#39;, &#39;Robert&#39;, &#39;Zoe&#39;))&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_table_obj values(type_t(1, &#39;shoes&#39;))&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;insert into test_table_obj values(type_t(2, &#39;pen&#39;))&quot;</span>));

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * drop_tables</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> drop_tables(<span class="keywordtype">void</span>)
{
    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; DROPPING TABLES AND TYPES \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_fetch&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_long_str&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_long_raw&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_lob&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_array&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_object&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_coll_varray&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_coll_nested&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_table_obj&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop table test_directpath&quot;</span>));

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop type  test_t&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop type  type_t&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop type  t_tab1_emp&quot;</span>));
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;drop type  t_tab2_emp&quot;</span>));

}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_format</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_format(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> code = 1;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST FORMATTING \n\n&quot;</span>);

    <a class="code" href="group__g__format.html#gae1b4805b4ed6530b496cd637b52a2adf" title="Execute a formatted SQL statement or PL/SQL block.">OCI_ExecuteStmtFmt</a>(st, MT(<span class="stringliteral">&quot;select * from test_fetch where code = %i&quot;</span>), code);

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        print_frmt(<span class="stringliteral">&quot;&gt; code : %i&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_text(<span class="stringliteral">&quot;, action : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 2));
        print_frmt(<span class="stringliteral">&quot;, price : %g&quot;</span>, <a class="code" href="group__g__fetch.html#gadfbe8b6c23200810823e9ca6a1956cd7" title="Return the current double value of the column at the given index in the resultset.">OCI_GetDouble</a>(rs,3));
        print_text(<span class="stringliteral">&quot;, date : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 4));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
   }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
}


<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_immediate</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_immediate(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> code = 1;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST IMMEDIATE \n\n&quot;</span>);

    <a class="code" href="group__g__format.html#ga85318e359913e49d5654d2f53a070ef7" title="Perform 3 calls (prepare+execute+fetch) in 1 call.">OCI_Immediate</a>(cn, MT(<span class="stringliteral">&quot;select code, article from test_fetch where code = 1&quot;</span>),
                  OCI_ARG_INT, &amp;code,
                  OCI_ARG_TEXT, temp);

    print_frmt(<span class="stringliteral">&quot;&gt; code : %i &quot;</span>, code);
    print_text(<span class="stringliteral">&quot;- article : &quot;</span>); print_dstr(temp);
    print_text(<span class="stringliteral">&quot;\n&quot;</span>);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_immediate_format</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_immediate_format(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> code = 1;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST IMMEDIATE FORMATTED\n\n&quot;</span>);

    <a class="code" href="group__g__format.html#ga845524c6dce7499a0cc27488052a93c2" title="Performs 4 call (prepare+bind+execute+fetch) in 1 call.">OCI_ImmediateFmt</a>(cn, MT(<span class="stringliteral">&quot;select article from test_fetch where code = %i&quot;</span>),
                     code, OCI_ARG_TEXT, temp);

    print_text(<span class="stringliteral">&quot;&gt; article : &quot;</span>); print_dstr(temp);  print_text(<span class="stringliteral">&quot;\n&quot;</span>);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_fetch</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_fetch(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> i, n;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; SIMPLE TEST FETCH WITH META DATA\n\n&quot;</span>);

    <span class="comment">/* execute query in one go */</span>
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select * from test_fetch&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);
    n  = <a class="code" href="group__g__fetch.html#ga8935f9c6ff0d6f1d94c70afb3418a916" title="Return the number of columns in the resultset.">OCI_GetColumnCount</a>(rs);

    <span class="comment">/* print resultset columns info */</span>
    <span class="keywordflow">for</span>(i = 1; i &lt;= n; i++)
    {
        <a class="code" href="struct_o_c_i___column.html" title="Oracle SQL Column and Type member representation.">OCI_Column</a> *col = <a class="code" href="group__g__fetch.html#ga7b64be082fc14ac73347b081cdb66de0" title="Return the column object handle at the given index in the resultset.">OCI_GetColumn</a>(rs, i);

        print_frmt(<span class="stringliteral">&quot;&gt; Field : #%i &quot;</span>, i);
        print_text(<span class="stringliteral">&quot;- Name  : &quot;</span>); print_mstr(<a class="code" href="group__g__fetch.html#gad22f87322cdb788a03a0c259ab126a94" title="Return the name of the given column.">OCI_ColumnGetName</a>(col));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    print_text(<span class="stringliteral">&quot;\n&quot;</span>);

    <span class="comment">/* print resultset content */</span>
    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        print_frmt(<span class="stringliteral">&quot;&gt; code : %i&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_text(<span class="stringliteral">&quot;, action : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 2));
        print_frmt(<span class="stringliteral">&quot;, price : %g&quot;</span>, <a class="code" href="group__g__fetch.html#gadfbe8b6c23200810823e9ca6a1956cd7" title="Return the current double value of the column at the given index in the resultset.">OCI_GetDouble</a>(rs,3));
        print_text(<span class="stringliteral">&quot;, date : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 4));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_bind1</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_bind1(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> code = 1;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST BINDING \n\n&quot;</span>);

    <span class="comment">/* execute query in three steps */</span>
    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;select * from test_fetch where code = :code&quot;</span>));
    <a class="code" href="group__g__bind.html#ga4d08024d2242b6140fecea8c2ec05c81" title="Bind an integer variable.">OCI_BindInt</a>(st, MT(<span class="stringliteral">&quot;:code&quot;</span>), &amp;code);
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="comment">/* print resultset content */</span>
    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        print_frmt(<span class="stringliteral">&quot;&gt; code : %i&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_text(<span class="stringliteral">&quot;, action : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 2));
        print_frmt(<span class="stringliteral">&quot;, price : %g&quot;</span>, <a class="code" href="group__g__fetch.html#gadfbe8b6c23200810823e9ca6a1956cd7" title="Return the current double value of the column at the given index in the resultset.">OCI_GetDouble</a>(rs,3));
        print_text(<span class="stringliteral">&quot;, date : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 4));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_bind2</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_bind2(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a> *lob;
    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a> *date;
    <a class="code" href="struct_o_c_i___file.html" title="Oracle External Large objects:">OCI_File</a> *file;

    <span class="keywordtype">int</span> i;
    <span class="keywordtype">double</span> flt;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; SINGLE BINDING \n\n&quot;</span>);

   <span class="comment">/* prepare SQL */</span>

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;insert into test_array &quot;</span>)
                    MT(<span class="stringliteral">&quot;( &quot;</span>)
                    MT(<span class="stringliteral">&quot;   val_int,  val_flt, val_str, val_date, &quot;</span>)
                    MT( <span class="stringliteral">&quot;   val_lob, val_file &quot;</span>)
                    MT( <span class="stringliteral">&quot;) &quot;</span> )
                    MT( <span class="stringliteral">&quot;values &quot;</span>)
                    MT( <span class="stringliteral">&quot;( &quot;</span>)
                    MT( <span class="stringliteral">&quot;   :val_int, :val_flt, :val_str, :val_date, &quot;</span>)
                    MT( <span class="stringliteral">&quot;   :val_lob, :val_file &quot;</span>)
                    MT(<span class="stringliteral">&quot;) &quot;</span>));

    <span class="comment">/* create objects and set values */</span>

    <span class="comment">/* date */</span>
    date = <a class="code" href="group__g__date.html#gae80eacef54641a68c3b82be85f4a5042" title="Create a local date object.">OCI_DateCreate</a>(cn);
    <a class="code" href="group__g__date.html#gad7c5c65d88b52e6ecb46b3e9ba8843dc" title="Return the current system date/time into the date handle.">OCI_DateSysDate</a>(date);

    <span class="comment">/* lob */</span>
    lob = <a class="code" href="group__g__lob.html#ga318f1273603e24b51c3d9e4c29f42685" title="Create a local temporary Lob instance.">OCI_LobCreate</a>(cn, OCI_CLOB);
    sprint_dt(temp, SIZE_STR, DT(<span class="stringliteral">&quot;lob value00&quot;</span>));
    <a class="code" href="group__g__lob.html#ga949f7050609430486c9ef0f3c488d38a" title="[OBSOLETE] Write a buffer into a LOB">OCI_LobWrite</a>(lob, temp, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) dtslen(temp));

    <span class="comment">/* file */</span>
    file = <a class="code" href="group__g__file.html#ga199d6ce1a1231feb56b456ad6cbc2714" title="Create a file object instance.">OCI_FileCreate</a>(cn, OCI_BFILE);
    <a class="code" href="group__g__file.html#gae31e36e786faf43a2663806a28814c68" title="Set the directory and file name of FILE handle.">OCI_FileSetName</a>(file, MT(<span class="stringliteral">&quot;mydir&quot;</span>), MT(<span class="stringliteral">&quot;file00.txt&quot;</span>));

    <span class="comment">/* scalar types */</span>
    i   = 1;
    flt = 3.14;
    sprint_dt(temp, 30, DT(<span class="stringliteral">&quot;Name00&quot;</span>));

    <span class="comment">/* bind scalar C types arrays */</span>

    <a class="code" href="group__g__bind.html#ga4d08024d2242b6140fecea8c2ec05c81" title="Bind an integer variable.">OCI_BindInt</a>(st, MT(<span class="stringliteral">&quot;:val_int&quot;</span>),  &amp;i);
    <a class="code" href="group__g__bind.html#ga66c7c882c40d302003b3b239b70c54d3" title="Bind a double variable.">OCI_BindDouble</a>(st, MT(<span class="stringliteral">&quot;:val_flt&quot;</span>), &amp;flt);
    <a class="code" href="group__g__bind.html#ga49988b9ca8f00b55cc3e62ca2385778b" title="Bind a string variable.">OCI_BindString</a>(st, MT(<span class="stringliteral">&quot;:val_str&quot;</span>), (dtext*) temp, 30);

    <span class="comment">/* bind oracle types arrays */</span>

    <a class="code" href="group__g__bind.html#gaa0000a7b00b751b88459692f6790e018" title="Bind a date variable.">OCI_BindDate</a>(st, MT(<span class="stringliteral">&quot;:val_date&quot;</span>), date);
    <a class="code" href="group__g__bind.html#gaeee7fa2d4a2bae58cd7cdf9348367ef2" title="Bind a Lob variable.">OCI_BindLob</a>(st, MT(<span class="stringliteral">&quot;:val_lob&quot;</span>), lob);
    <a class="code" href="group__g__bind.html#ga92cba59c0aabe28391b5e7053baee708" title="Bind a File variable.">OCI_BindFile</a>(st, MT(<span class="stringliteral">&quot;:val_file&quot;</span>), file);

    <span class="comment">/* do insert */</span>

    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    print_frmt(<span class="stringliteral">&quot;Row inserted : %d\n\n&quot;</span>, <a class="code" href="group__g__exec.html#ga1cf932261960da80cd36d650a08565c3" title="Return the number of rows affected by the SQL statement.">OCI_GetAffectedRows</a>(st));

    <span class="comment">/* free objets */</span>

    <a class="code" href="group__g__date.html#gaedf77cfe4bd5dab7909e4c2fb5173b48" title="Free a date object.">OCI_DateFree</a>(date);
    <a class="code" href="group__g__lob.html#gaac269a3de312c2c7d1a6193a9ab79545" title="Free a local temporary lob.">OCI_LobFree</a>(lob);
    <a class="code" href="group__g__file.html#gad4b58b6d80e24bb045fb82d78c5cf36a" title="Free a local File object.">OCI_FileFree</a>(file);

    <span class="comment">/* commit; */</span>

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_piecewise_insert</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_piecewise_insert(<span class="keywordtype">void</span>)
{
    FILE *f;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST PIECEWISE INSERTING\n\n&quot;</span>);

    <span class="comment">/* this code could have been used with a text file in a LONG column</span>
<span class="comment">       as well...  */</span>

    <span class="comment">/* open the app file in for reading*/</span>

    f = fopen(EXE_NAME, <span class="stringliteral">&quot;rb&quot;</span>);

    <span class="keywordflow">if</span> (f)
    {
        <span class="keywordtype">int</span> n;
        <a class="code" href="struct_o_c_i___long.html" title="Oracle Long datatype.">OCI_Long</a> *lg;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[SIZE_BUF];

        fseek (f , 0 , SEEK_END);
        n = ftell(f);
        rewind (f);

        print_frmt(<span class="stringliteral">&quot;\n%d bytes to write\n&quot;</span>, n);

        lg = <a class="code" href="group__g__long.html#ga040ec19ae09a29b34e0143e39ab30939" title="Create a local temporary Long instance.">OCI_LongCreate</a>(st, OCI_BLONG);

        <span class="comment">/* execute query in three steps */</span>
        <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st,  MT(<span class="stringliteral">&quot;insert into test_long_raw(code, content) &quot;</span>)
                         MT(<span class="stringliteral">&quot;values (1, :data)&quot;</span>));

        <a class="code" href="group__g__bind.html#gaec1215548d35bff084c1284e303f31f6" title="Bind a Long variable.">OCI_BindLong</a>(st, MT(<span class="stringliteral">&quot;:data&quot;</span>), lg, n);
        <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

        <span class="comment">/* write data into table by chunks of 2048 bytes */</span>
        <span class="keywordflow">while</span> ((n = (<span class="keywordtype">int</span>) fread(buffer, 1, <span class="keyword">sizeof</span>(buffer), f)))
        {
            <a class="code" href="group__g__long.html#ga1a76c2c5de1c81d38be17bf28524ce99" title="Write a buffer into a Long.">OCI_LongWrite</a>(lg, buffer, n);
        }

        print_frmt(<span class="stringliteral">&quot;\n%d bytes written\n&quot;</span>, <a class="code" href="group__g__long.html#gaf7ed15bc901e38b9bc3394f334bf8d4c" title="Return the buffer size of a long object in bytes (OCI_BLONG) or character (OCI_CLONG)">OCI_LongGetSize</a>(lg));
        fclose(f);

        <a class="code" href="group__g__long.html#gadc23551bd5aa7832cbaee4e32a2b283a" title="Free a local temporary long.">OCI_LongFree</a>(lg);
        <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_piecewise_fetch</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_piecewise_fetch(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___long.html" title="Oracle Long datatype.">OCI_Long</a> *lg;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[SIZE_BUF];
    <span class="keywordtype">int</span> n;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST PIECEWISE FETCHING\n\n&quot;</span>);

    <span class="comment">/* execute query in one go */</span>
    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select content from test_long_raw &quot;</span>)
                              MT(<span class="stringliteral">&quot;where code = 1&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="comment">/* read data by chunks of 2048 bytes*/</span>
    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        lg = <a class="code" href="group__g__fetch.html#ga8c750dc1ea6d90c61cc2ebff5fb0c561" title="Return the current Long value of the column at the given index in the resultset.">OCI_GetLong</a>(rs, 1);

        <span class="keywordflow">while</span> ((n = <a class="code" href="group__g__long.html#gad7e0ba53269cc2d5aace557a984c8717" title="Read a portion of a long into the given buffer [Obsolete].">OCI_LongRead</a>(lg, buffer, <span class="keyword">sizeof</span>(buffer)))) {}

        print_frmt(<span class="stringliteral">&quot;\n%d bytes read\n&quot;</span>, <a class="code" href="group__g__long.html#gaf7ed15bc901e38b9bc3394f334bf8d4c" title="Return the buffer size of a long object in bytes (OCI_BLONG) or character (OCI_CLONG)">OCI_LongGetSize</a>(lg));
    }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST LONG MAPPED TO STRING\n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select content from test_long_str &quot;</span>)
                        MT(<span class="stringliteral">&quot;where code = 1&quot;</span>));
    <a class="code" href="group__g__stmt.html#gae92422b723eef25355d91e0b50c09c0c" title="Set the long datatype handling mode of a SQL statement.">OCI_SetLongMode</a>(st, OCI_LONG_IMPLICIT);
    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        <span class="keyword">const</span> dtext *long_str = <a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1);

        print_dstr(long_str);
        print_frmt(<span class="stringliteral">&quot;\n%d bytes read\n&quot;</span>, dtslen(long_str));
    }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_lob</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_lob(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a> *lob;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST LOB MANIPULATION\n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select code, content from test_lob &quot;</span>)
                        MT(<span class="stringliteral">&quot;where code=1 for update&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        lob  = <a class="code" href="group__g__fetch.html#gabac23a7dea02963ef8de438950ef6fae" title="Return the current lob value of the column at the given index in the resultset.">OCI_GetLob</a>(rs, 2);

        <a class="code" href="group__g__lob.html#ga949f7050609430486c9ef0f3c488d38a" title="[OBSOLETE] Write a buffer into a LOB">OCI_LobWrite</a>(lob, DT(<span class="stringliteral">&quot;today, &quot;</span>), 7);
        <a class="code" href="group__g__lob.html#ga7bfac772587753b2cef9c5a704ae7ce9" title="Append a buffer at the end of a LOB.">OCI_LobAppend</a>(lob, DT(<span class="stringliteral">&quot;i&#39;m going to the cinema ! &quot;</span>), 26);
        <a class="code" href="group__g__lob.html#ga63df7f944c418642fc04571a4a522b87" title="Perform a seek operation on the OCI_lob content buffer.">OCI_LobSeek</a>(lob, 0, OCI_SEEK_SET);

        temp[<a class="code" href="group__g__lob.html#ga36708313dc7d5c0b2c30f7f8b9fa2e2d" title="[OBSOLETE] Read a portion of a lob into the given buffer">OCI_LobRead</a>(lob, temp, SIZE_STR)] = 0;

        print_frmt(<span class="stringliteral">&quot;&gt; code    : %i&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_text(<span class="stringliteral">&quot;, content : &quot;</span>); print_dstr(temp);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_nested_table</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_nested_table(<span class="keywordtype">void</span>)
{
    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST NESTED TABLE \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select article, cursor(select sysdate &quot;</span>)
                        MT(<span class="stringliteral">&quot;from dual) from test_fetch&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        <a class="code" href="struct_o_c_i___statement.html" title="Oracle SQL or PL/SQL statement.">OCI_Statement</a> *st2 = <a class="code" href="group__g__fetch.html#ga9b73fe347ad581a6493845e6d0c3d04d" title="Return the current cursor value (Nested table) of the column at the given index in the resultset...">OCI_GetStatement</a>(rs, 2);
        <a class="code" href="struct_o_c_i___resultset.html" title="Collection of output columns from a select statement.">OCI_Resultset</a> *rs2 = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st2);

        <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs2))
        {
            print_text(<span class="stringliteral">&quot;&gt; article : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;, date : &quot;</span>);    print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs2, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_ref_cursor</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_ref_cursor(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___statement.html" title="Oracle SQL or PL/SQL statement.">OCI_Statement</a>* st2 = <a class="code" href="group__g__exec.html#ga335822f983af0fb5c529431f06a9a17b" title="Create a statement object and return its handle.">OCI_StatementCreate</a>(cn);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST REF CURSOR \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;begin open :c for select * from test_fetch; end;&quot;</span>));
    <a class="code" href="group__g__bind.html#gabaad664721d7f6d2a029e1eba90ba11b" title="Bind a Statement variable (PL/SQL Ref Cursor)">OCI_BindStatement</a>(st, MT(<span class="stringliteral">&quot;:c&quot;</span>), st2);
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st2);

    <span class="comment">/* print resultset content */</span>
    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        print_frmt(<span class="stringliteral">&quot;&gt; code : %i&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_text(<span class="stringliteral">&quot;, action : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 2));
        print_frmt(<span class="stringliteral">&quot;, price : %g&quot;</span>, <a class="code" href="group__g__fetch.html#gadfbe8b6c23200810823e9ca6a1956cd7" title="Return the current double value of the column at the given index in the resultset.">OCI_GetDouble</a>(rs,3));
        print_text(<span class="stringliteral">&quot;, date : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 4));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));

    <a class="code" href="group__g__exec.html#ga487b4f90f1fd4aee18f3d901f5aed104" title="Free a statement and all resources associated to it (resultsets ...)">OCI_StatementFree</a>(st2);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_plsql</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_plsql(<span class="keywordtype">void</span>)
{
    <span class="keywordtype">int</span> res = 0;
    <span class="keyword">const</span> dtext *p=NULL;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST PL/SQL OUTPUT BIND\n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;begin :res := trunc(sysdate+1)-trunc(sysdate-1); end;&quot;</span>));
    <a class="code" href="group__g__bind.html#ga4d08024d2242b6140fecea8c2ec05c81" title="Bind an integer variable.">OCI_BindInt</a>(st, MT(<span class="stringliteral">&quot;:res&quot;</span>), &amp;res);
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    print_text(<span class="stringliteral">&quot;\nPL/SQL : trunc(sysdate+1)-trunc(sysdate-1)\n&quot;</span>);
    print_frmt(<span class="stringliteral">&quot;\nResult : %i\n&quot;</span>, res);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST PL/SQL SERVER OUTPUT\n\n&quot;</span>);

    <span class="comment">/* server output */</span>

    <a class="code" href="group__g__plsql.html#gaeff8f38ba15b9e757cec70d91e4ffe13" title="Enable the server output.">OCI_ServerEnableOutput</a>(cn, 32000, 5, 255);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;begin &quot;</span>)
                        MT(<span class="stringliteral">&quot;   dbms_output.put_line(&#39;First  line&#39;); &quot;</span>)
                        MT(<span class="stringliteral">&quot;   dbms_output.put_line(&#39;Second line&#39;); &quot;</span>)
                        MT(<span class="stringliteral">&quot;   dbms_output.put_line(&#39;Third  line&#39;); &quot;</span>)
                        MT(<span class="stringliteral">&quot;end;&quot;</span>)
                   );

    <span class="keywordflow">while</span> ((p = <a class="code" href="group__g__plsql.html#gabb13df960f035cd9e48e774c39db425a" title="Retrieve one line of the server buffer.">OCI_ServerGetOutput</a>(cn)))
    {
        print_dstr(p);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    <a class="code" href="group__g__plsql.html#ga0d3321a0abff0722baf6b2b7233f4cb5" title="Disable the server output.">OCI_ServerDisableOutput</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_dates</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_dates(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a> *date, *date2;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST DATETIME MANIPULATION\n\n&quot;</span>);

    date  = <a class="code" href="group__g__date.html#gae80eacef54641a68c3b82be85f4a5042" title="Create a local date object.">OCI_DateCreate</a>(NULL);
    date2 = <a class="code" href="group__g__date.html#gae80eacef54641a68c3b82be85f4a5042" title="Create a local date object.">OCI_DateCreate</a>(NULL);

    <a class="code" href="group__g__date.html#gae0a2778f7c5646df7ea8748d7683b76b" title="Convert a string to a date and store it in the given date handle.">OCI_DateFromText</a>(date, MT(<span class="stringliteral">&quot;1978-04-13 20:20:12&quot;</span>), MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>));
    <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), SIZE_STR, str);
    print_text(<span class="stringliteral">&quot;\nDate                     : &quot;</span>); print_mstr(str);

    <a class="code" href="group__g__date.html#gad7c5c65d88b52e6ecb46b3e9ba8843dc" title="Return the current system date/time into the date handle.">OCI_DateSysDate</a>(date);
    <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), SIZE_STR, str);
    print_text(<span class="stringliteral">&quot;\nSysdate                  : &quot;</span>); print_mstr(str);

    <a class="code" href="group__g__date.html#ga7f446c4dc922920c36601770e3d9d7d1" title="Add or subtract days to a date handle.">OCI_DateAddDays</a>(date, 5);
    <a class="code" href="group__g__date.html#gaa405c4bb8c705ce2dd03b51bba1ef303" title="Add or subtract months to a date handle.">OCI_DateAddMonths</a>(date, 2);
    <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), SIZE_STR, str);
    print_text(<span class="stringliteral">&quot;\nDate + 5 days + 2 months : &quot;</span>); print_mstr(str);

    <a class="code" href="group__g__date.html#gad66b48f587f3bc30b1db8cd4cb892847" title="Assign the value of a date handle to another one.">OCI_DateAssign</a>(date2, date);
    <a class="code" href="group__g__date.html#ga0d174f4b5db6961053807efe1698ea81" title="Place the last day of month (from the given date) into the given date.">OCI_DateLastDay</a>(date);
    <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD&quot;</span>), SIZE_STR, str);
    print_text(<span class="stringliteral">&quot;\nLast day of the month    : &quot;</span>); print_mstr(str);

    print_frmt(<span class="stringliteral">&quot;\nEnd of the month - date  : %i days&quot;</span>,
               <a class="code" href="group__g__date.html#gafa9f51e0977278bc43dafdef13d7fb5e" title="Return the number of days betWeen two dates.">OCI_DateDaysBetween</a>(date, date2));
    print_text(<span class="stringliteral">&quot;\n&quot;</span>);

    <a class="code" href="group__g__date.html#gaedf77cfe4bd5dab7909e4c2fb5173b48" title="Free a date object.">OCI_DateFree</a>(date);
    <a class="code" href="group__g__date.html#gaedf77cfe4bd5dab7909e4c2fb5173b48" title="Free a date object.">OCI_DateFree</a>(date2);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_timestamp</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_timestamp(<span class="keywordtype">void</span>)
{
<span class="preprocessor">#ifndef OCI_CHARSET_ANSI</span>
<span class="preprocessor"></span>
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> version = <a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>();

    <span class="comment">/* Oracle 9i has some troubles with formatting Intervals/timestamps in</span>
<span class="comment">       an UTF16 context... */</span>

    <span class="keywordflow">if</span> ((version &gt;= OCI_9_0) || (version &lt; OCI_10_1))
        <span class="keywordflow">return</span>;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> (<a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>() &gt;= OCI_9_0)
    {
        <a class="code" href="struct_o_c_i___timestamp.html" title="Oracle internal timestamp representation.">OCI_Timestamp</a> *tmsp;

        print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST TIMESTAMP\n\n&quot;</span>);

        tmsp = <a class="code" href="group__g__timestamp.html#ga5c590ea371920703997cd7bea126ad9d" title="Create a local Timestamp instance.">OCI_TimestampCreate</a>(NULL, OCI_TIMESTAMP);

        OCI_TimestampSysTimeStamp(tmsp);

        <a class="code" href="group__g__timestamp.html#gab737b5a0c898dde2381fd095dd4e2b65" title="Convert a timestamp value from the given timestamp handle to a string.">OCI_TimestampToText</a>(tmsp, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS:FF\n&quot;</span>), SIZE_STR, str, 3);


        print_text(<span class="stringliteral">&quot;Current timestamp            : &quot;</span>); print_mstr(str);

        <span class="comment">/* intervals raw oci functions have some troubles with Oracle 9i. So let&#39;s</span>
<span class="comment">           use it for the demo only if we&#39;re using 10g or above */</span>

        <span class="keywordflow">if</span> (<a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>() &gt;= OCI_10_1)
        {
            <a class="code" href="struct_o_c_i___interval.html" title="Oracle internal interval representation.">OCI_Interval</a> *itv;

            print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST INTERVAL \n\n&quot;</span>);

            itv = <a class="code" href="group__g__timestamp.html#ga4748278cf01c5e927137ce3342038fd7" title="Create a local interval object.">OCI_IntervalCreate</a>(NULL, OCI_INTERVAL_DS);

            <a class="code" href="group__g__timestamp.html#ga5fa498aad5bf6a1b2bd899a0f054432a" title="Set the day / time portion if the given interval handle.">OCI_IntervalSetDaySecond</a>(itv, 1,1,1,1,0);

            <a class="code" href="group__g__timestamp.html#ga42e529414447c9e906916029cfc5895f" title="Convert an interval value from the given interval handle to a string.">OCI_IntervalToText</a>(itv, 3, 3, SIZE_STR, str);

            print_text(<span class="stringliteral">&quot;Interval                     : &quot;</span>); print_mstr(str);
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            <a class="code" href="group__g__timestamp.html#ga43028a0463f25bcd9665993a244572e7" title="Add an interval value to a timestamp value of a timestamp handle.">OCI_TimestampIntervalAdd</a>(tmsp, itv);

            <a class="code" href="group__g__timestamp.html#gab737b5a0c898dde2381fd095dd4e2b65" title="Convert a timestamp value from the given timestamp handle to a string.">OCI_TimestampToText</a>(tmsp, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS:FF\n&quot;</span>), SIZE_STR, str, 3);

            print_text(<span class="stringliteral">&quot;Current timestamp + Interval : &quot;</span>); print_mstr(str);

            <a class="code" href="group__g__timestamp.html#ga7623b368ab3486c15c6d671054fac3e3" title="Free an OCI_Interval handle.">OCI_IntervalFree</a>(itv);
        }

        <a class="code" href="group__g__timestamp.html#ga60e9851db1175d6b650f9df00db274da" title="Free an OCI_Timestamp handle.">OCI_TimestampFree</a>(tmsp);
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_describe</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_describe(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___column.html" title="Oracle SQL Column and Type member representation.">OCI_Column</a>   *col;
    <a class="code" href="struct_o_c_i___type_info.html" title="Type info metadata handle.">OCI_TypeInfo</a> *tbl;

    <span class="keywordtype">int</span> i, n;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST DESCRIBING TABLE \n\n&quot;</span>);

    tbl = <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;test_fetch&quot;</span>), OCI_TIF_TABLE);

    <span class="keywordflow">if</span> (tbl)
    {
        print_text(<span class="stringliteral">&quot;Column Name         NULL ?  Type                        \n&quot;</span>);
        print_text(<span class="stringliteral">&quot;--------------------------------------------------------\n&quot;</span>);

        n = <a class="code" href="group__g__desc.html#ga9c93a72421d19de30acbf05a53353c93" title="Retruns the number of columns of a table/view/object.">OCI_TypeInfoGetColumnCount</a>(tbl);

        <span class="keywordflow">for</span>(i = 1; i &lt;= n; i++)
        {
            col = <a class="code" href="group__g__desc.html#gab22a6fcb3d64c74adfc7506f1ce343d7" title="Return the column object handle at the given index in the table.">OCI_TypeInfoGetColumn</a>(tbl, i);

            <a class="code" href="group__g__fetch.html#gadfb47f7b31c212ef301e7eaa9cd13c4b" title="Return the Oracle SQL Full name including precision and size of the column datatype.">OCI_ColumnGetFullSQLType</a>(col, str, SIZE_STR);

<span class="preprocessor">#if defined(OCI_CHARSET_WIDE)</span>
<span class="preprocessor"></span><span class="preprocessor">  #if !defined(_WINDOWS)</span>
<span class="preprocessor"></span>            printf(<span class="stringliteral">&quot;%-20ls%-8ls%-30ls\n&quot;</span>,
  #<span class="keywordflow">else</span>
            wprintf(MT(<span class="stringliteral">&quot;%-20s%-8s%-30s\n&quot;</span>),
  #endif
#<span class="keywordflow">else</span>
            printf(<span class="stringliteral">&quot;%-20s%-8s%-30s\n&quot;</span>,
#endif
                    <a class="code" href="group__g__fetch.html#gad22f87322cdb788a03a0c259ab126a94" title="Return the name of the given column.">OCI_ColumnGetName</a>(col),
                    <a class="code" href="group__g__fetch.html#ga741f0a6b17d20da49772c564bf2657cd" title="Return the nullable attribute of the column.">OCI_ColumnGetNullable</a>(col) == TRUE ? MT(<span class="stringliteral">&quot;Y&quot;</span>) : MT(<span class="stringliteral">&quot;N&quot;</span>),
                    str);
        }
    }

    <a class="code" href="group__g__desc.html#ga5d8b11bf30702727e7c0499875ab9142" title="Free a type info object.">OCI_TypeInfoFree</a>(tbl);

    <span class="comment">/* TEST DESCRIBING TYPE ------------------------------------------------- */</span>

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST DESCRIBING TYPE \n\n&quot;</span>);

    tbl = <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;test_t&quot;</span>), OCI_TIF_TYPE);

    <span class="keywordflow">if</span> (tbl)
    {
        print_text(<span class="stringliteral">&quot;Column Name         Type                           \n&quot;</span>);
        print_text(<span class="stringliteral">&quot;---------------------------------------------------\n&quot;</span>);

        n = <a class="code" href="group__g__desc.html#ga9c93a72421d19de30acbf05a53353c93" title="Retruns the number of columns of a table/view/object.">OCI_TypeInfoGetColumnCount</a>(tbl);

        <span class="keywordflow">for</span>(i = 1; i &lt;= n; i++)
        {
            col = <a class="code" href="group__g__desc.html#gab22a6fcb3d64c74adfc7506f1ce343d7" title="Return the column object handle at the given index in the table.">OCI_TypeInfoGetColumn</a>(tbl, i);

            <a class="code" href="group__g__fetch.html#gadfb47f7b31c212ef301e7eaa9cd13c4b" title="Return the Oracle SQL Full name including precision and size of the column datatype.">OCI_ColumnGetFullSQLType</a>(col, str, SIZE_STR);

<span class="preprocessor">#if defined(OCI_CHARSET_WIDE)</span>
<span class="preprocessor"></span><span class="preprocessor">  #if !defined(_WINDOWS)</span>
<span class="preprocessor"></span>            printf(<span class="stringliteral">&quot;%-20ls%-30ls\n&quot;</span>,
  #<span class="keywordflow">else</span>
            wprintf(MT(<span class="stringliteral">&quot;%-20s%-30s\n&quot;</span>),
  #endif
#<span class="keywordflow">else</span>
            printf(<span class="stringliteral">&quot;%-20s%-30s\n&quot;</span>,
#endif
                    <a class="code" href="group__g__fetch.html#gad22f87322cdb788a03a0c259ab126a94" title="Return the name of the given column.">OCI_ColumnGetName</a>(col),  str);
        }
    }

    <a class="code" href="group__g__desc.html#ga5d8b11bf30702727e7c0499875ab9142" title="Free a type info object.">OCI_TypeInfoFree</a>(tbl);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_returning</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_returning(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a> *lob;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST RETURNING CLAUSE \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;update test_lob set code = code + 1 returning code, content into :i, :l&quot;</span>));
    <a class="code" href="group__g__ora__ret.html#gabb64a69d45293b80324657dec0f76735" title="Register a lob output bind placeholder.">OCI_RegisterLob</a>(st, MT(<span class="stringliteral">&quot;:l&quot;</span>), OCI_CLOB);
    <a class="code" href="group__g__ora__ret.html#ga85af8fc84e655f867653ec7eb8de770e" title="Register an integer output bind placeholder.">OCI_RegisterInt</a>(st, MT(<span class="stringliteral">&quot;:i&quot;</span>));
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        lob = <a class="code" href="group__g__fetch.html#gabac23a7dea02963ef8de438950ef6fae" title="Return the current lob value of the column at the given index in the resultset.">OCI_GetLob</a>(rs, 2);

        <a class="code" href="group__g__lob.html#ga7bfac772587753b2cef9c5a704ae7ce9" title="Append a buffer at the end of a LOB.">OCI_LobAppend</a>(lob, DT(<span class="stringliteral">&quot;(modified)&quot;</span>), 10);
        <a class="code" href="group__g__lob.html#ga63df7f944c418642fc04571a4a522b87" title="Perform a seek operation on the OCI_lob content buffer.">OCI_LobSeek</a>(lob, 0, OCI_SEEK_SET);

        temp[<a class="code" href="group__g__lob.html#ga36708313dc7d5c0b2c30f7f8b9fa2e2d" title="[OBSOLETE] Read a portion of a lob into the given buffer">OCI_LobRead</a>(lob, temp, SIZE_STR)] = 0;

        print_frmt(<span class="stringliteral">&quot;&gt; code : %i - &quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));
        print_dstr(temp);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
   }

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) fetched\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_returning_array</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_returning_array(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a> *lob;
    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a> *date;
    <a class="code" href="struct_o_c_i___file.html" title="Oracle External Large objects:">OCI_File</a> *file;
    <span class="keywordtype">int</span> i;

    <span class="comment">/* arrays */</span>
    <span class="keywordtype">int</span>       tab_int [SIZE_TAB];
    dtext     tab_str [SIZE_TAB][31];
    <span class="keywordtype">double</span>    tab_flt [SIZE_TAB];

    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a>  **tab_date = <a class="code" href="group__g__date.html#ga60ba27b663a99d407b837ce665291f03" title="Create an array of date object.">OCI_DateArrayCreate</a>(cn, SIZE_TAB);
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a>   **tab_lob  = <a class="code" href="group__g__lob.html#ga00934ab657273e10a3dea6c16b32de5f" title="Create an array of lob object.">OCI_LobArrayCreate</a>(cn,  OCI_CLOB, SIZE_TAB);
    <a class="code" href="struct_o_c_i___file.html" title="Oracle External Large objects:">OCI_File</a>  **tab_file = <a class="code" href="group__g__file.html#gac74441cd7b3b7fe7e815b4be2fe48c49" title="Create an array of file object.">OCI_FileArrayCreate</a>(cn, OCI_BFILE, SIZE_TAB);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST ARRAY BINDING WITH RETURNING CLAUSE \n\n&quot;</span>);

    <span class="comment">/* prepare SQL */</span>

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;insert into test_array &quot;</span>)
                    MT(<span class="stringliteral">&quot;( &quot;</span>)
                    MT(<span class="stringliteral">&quot;   val_int,  val_flt, val_str, val_date, &quot;</span>)
                    MT( <span class="stringliteral">&quot;   val_lob, val_file &quot;</span>)
                    MT( <span class="stringliteral">&quot;) &quot;</span> )
                    MT( <span class="stringliteral">&quot;values &quot;</span>)
                    MT( <span class="stringliteral">&quot;( &quot;</span>)
                    MT( <span class="stringliteral">&quot;   :val_int, :val_flt, :val_str, :val_date, &quot;</span>)
                    MT( <span class="stringliteral">&quot;   :val_lob, :val_file &quot;</span>)
                    MT(<span class="stringliteral">&quot;) &quot;</span>)
                    MT(<span class="stringliteral">&quot;returning&quot;</span>)
                    MT( <span class="stringliteral">&quot;  val_int,  val_flt, val_str, val_date, &quot;</span>)
                    MT(<span class="stringliteral">&quot;   val_lob, val_file &quot;</span>)
                    MT(<span class="stringliteral">&quot;into  &quot;</span> )
                    MT( <span class="stringliteral">&quot;  :out_int, :out_flt,  :out_str, :out_date, &quot;</span>)
                    MT(<span class="stringliteral">&quot;   :out_lob, :out_file &quot;</span>));

    <span class="comment">/* Set Array Size */</span>

    <a class="code" href="group__g__bind.html#ga60d87fbeb94afeaf410ec243eb8c0f98" title="Set the input array size for bulk operations.">OCI_BindArraySetSize</a>(st, SIZE_TAB);

    <span class="comment">/* bind scalar C types arrays */</span>

    <a class="code" href="group__g__bind.html#gaaaaf4e6e0331f7a6e62a9a81d45c3a3e" title="Bind an array of integers.">OCI_BindArrayOfInts</a>(st, MT(<span class="stringliteral">&quot;:val_int&quot;</span>),  tab_int, 0);
    <a class="code" href="group__g__bind.html#ga8ff8d8323c683be54a4a3fdd6a66f044" title="Bind an array of doubles.">OCI_BindArrayOfDoubles</a>(st, MT(<span class="stringliteral">&quot;:val_flt&quot;</span>), tab_flt, 0);
    <a class="code" href="group__g__bind.html#ga502cd4785691b17955f5d99276e48884" title="Bind an array of strings.">OCI_BindArrayOfStrings</a>(st, MT(<span class="stringliteral">&quot;:val_str&quot;</span>), (dtext*) tab_str, 30, 0);

    <span class="comment">/* bind oracle types arrays */</span>

    <a class="code" href="group__g__bind.html#ga477eb5dbc60c3056c794e2fb953b3531" title="Bind an array of dates.">OCI_BindArrayOfDates</a>(st, MT(<span class="stringliteral">&quot;:val_date&quot;</span>), tab_date, 0);
    <a class="code" href="group__g__bind.html#ga8f6a372772dacb5eafe2558fd6e9a059" title="Bind an array of Lob handles.">OCI_BindArrayOfLobs</a>(st, MT(<span class="stringliteral">&quot;:val_lob&quot;</span>), tab_lob, OCI_CLOB, 0);
    <a class="code" href="group__g__bind.html#ga90226a0a37f71d9503a6cdf9030593c7" title="Bind an array of File handles.">OCI_BindArrayOfFiles</a>(st, MT(<span class="stringliteral">&quot;:val_file&quot;</span>), tab_file, OCI_BFILE, 0);

    <span class="comment">/* register C scalar types output */</span>

    <a class="code" href="group__g__ora__ret.html#ga85af8fc84e655f867653ec7eb8de770e" title="Register an integer output bind placeholder.">OCI_RegisterInt</a>(st, MT(<span class="stringliteral">&quot;:out_int&quot;</span>));
    <a class="code" href="group__g__ora__ret.html#ga2e1496d575f30dfdcabb2310240c1b8a" title="Register a double output bind placeholder.">OCI_RegisterDouble</a>(st, MT(<span class="stringliteral">&quot;:out_flt&quot;</span>));
    <a class="code" href="group__g__ora__ret.html#gac2223b3c43382439afbb09cf70290ecc" title="Register a string output bind placeholder.">OCI_RegisterString</a>(st, MT(<span class="stringliteral">&quot;:out_str&quot;</span>), 30);

    <span class="comment">/* bind oracle types outputs */</span>

    <a class="code" href="group__g__ora__ret.html#gadb32a019872260d7ef4c0e25f7d1b796" title="Register a date output bind placeholder.">OCI_RegisterDate</a>(st, MT(<span class="stringliteral">&quot;:out_date&quot;</span>));
    <a class="code" href="group__g__ora__ret.html#gabb64a69d45293b80324657dec0f76735" title="Register a lob output bind placeholder.">OCI_RegisterLob</a>(st, MT(<span class="stringliteral">&quot;:out_lob&quot;</span>), OCI_CLOB);
    <a class="code" href="group__g__ora__ret.html#gaaacdce279df2733602d0b87f8ce0e12f" title="Register a file output bind placeholder.">OCI_RegisterFile</a>(st, MT(<span class="stringliteral">&quot;:out_file&quot;</span>), OCI_BFILE);

    <span class="comment">/* create objects and set values */</span>

    <span class="keywordflow">for</span>(i = 0; i &lt; SIZE_TAB; i++)
    {
        <span class="comment">/* scalar types */</span>
        tab_int[i] = i+1;
        tab_flt[i] = 3.14*(double)(i+1);
        sprint_dt(tab_str[i], 30, DT(<span class="stringliteral">&quot;Name%02i&quot;</span>), i+1);

        <span class="comment">/* date */</span>
        <a class="code" href="group__g__date.html#gad7c5c65d88b52e6ecb46b3e9ba8843dc" title="Return the current system date/time into the date handle.">OCI_DateSysDate</a>(tab_date[i]);

        <span class="comment">/* lob */</span>
        sprint_dt(temp, SIZE_STR, DT(<span class="stringliteral">&quot;lob value%02i&quot;</span>), i+1);
        <a class="code" href="group__g__lob.html#ga949f7050609430486c9ef0f3c488d38a" title="[OBSOLETE] Write a buffer into a LOB">OCI_LobWrite</a>(tab_lob[i], temp, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) dtslen(temp));

        <span class="comment">/* file */</span>
        sprint_mt(str, SIZE_STR, MT(<span class="stringliteral">&quot;file%02i.txt&quot;</span>), i+1);
        <a class="code" href="group__g__file.html#gae31e36e786faf43a2663806a28814c68" title="Set the directory and file name of FILE handle.">OCI_FileSetName</a>(tab_file[i], MT(<span class="stringliteral">&quot;mydir&quot;</span>), str);
    }

    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    print_frmt(<span class="stringliteral">&quot;Row inserted : %d\n\n&quot;</span>, <a class="code" href="group__g__exec.html#ga1cf932261960da80cd36d650a08565c3" title="Return the number of rows affected by the SQL statement.">OCI_GetAffectedRows</a>(st));

    <span class="comment">/* free objects */</span>

    <a class="code" href="group__g__date.html#gaa816548e8ae506c965d46811f7ffecf5" title="Free an arrray of date objects.">OCI_DateArrayFree</a>(tab_date);
    <a class="code" href="group__g__lob.html#ga4e317df72cb3e3014c9161c892e68186" title="Free an arrray of lob objects.">OCI_LobArrayFree</a>(tab_lob);
    <a class="code" href="group__g__file.html#ga081c016b3b514bd47f3f9cb8656215ea" title="Free an array of file objects.">OCI_FileArrayFree</a>(tab_file);

    <span class="comment">/* Get back data  from the returning clause</span>
<span class="comment">       Obviously, each entry of the array will return a resultset containing</span>
<span class="comment">       1 row only (DML insert)</span>
<span class="comment">    */</span>

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    i = 1;

    <span class="keywordflow">while</span> (rs != NULL)
    {
        <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
        {
            print_frmt(<span class="stringliteral">&quot;Row # %d-------------------\n&quot;</span>, i);

            print_frmt(<span class="stringliteral">&quot;.... val_int    : %i\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga7a4c04c9a228a8e1ba54b469d06d6c8c" title="Return the current integer value of the column from its name in the resultset.">OCI_GetInt2</a>(rs, MT(<span class="stringliteral">&quot;:OUT_INT&quot;</span>)));
            print_frmt(<span class="stringliteral">&quot;.... val_flt    : %g\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga22afd2865d436fbcadf6a25b83cfb2c0" title="Return the current double value of the column from its name in the resultset.">OCI_GetDouble2</a>(rs, MT(<span class="stringliteral">&quot;:OUT_FLT&quot;</span>)));
            print_text(<span class="stringliteral">&quot;.... val_str    : &quot;</span>); print_dstr(<a class="code" href="group__g__fetch.html#ga7252861cfef3e1e1482c57bc91744a3d" title="Return the current string value of the column from its name in the resultset.">OCI_GetString2</a>(rs, MT(<span class="stringliteral">&quot;:OUT_STR&quot;</span>)));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            date = <a class="code" href="group__g__fetch.html#ga1ad37dce6d6e900e98d39b2b2e0f5022" title="Return the current date value of the column at the given index in the resultset.">OCI_GetDate</a>(rs, 4);
            <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), SIZE_STR, str);
            print_text(<span class="stringliteral">&quot;.... val_date   : &quot;</span>); print_mstr(str);
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            lob  = <a class="code" href="group__g__fetch.html#gabac23a7dea02963ef8de438950ef6fae" title="Return the current lob value of the column at the given index in the resultset.">OCI_GetLob</a>(rs, 5);
            temp[<a class="code" href="group__g__lob.html#ga36708313dc7d5c0b2c30f7f8b9fa2e2d" title="[OBSOLETE] Read a portion of a lob into the given buffer">OCI_LobRead</a>(lob, temp, 100)]=0;
            print_text(<span class="stringliteral">&quot;.... val_lob    : &quot;</span>); print_dstr(temp);
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            file = <a class="code" href="group__g__fetch.html#ga1f4362d4f0ad420ebfaeafca29670d77" title="Return the current File value of the column at the given index in the resultset.">OCI_GetFile</a>(rs, 6);
            print_text(<span class="stringliteral">&quot;.... val_file   : &quot;</span>);
            print_mstr(<a class="code" href="group__g__file.html#ga920ae6408404696e2c76cfc73a568136" title="Return the directory of the given file.">OCI_FileGetDirectory</a>(file));
            print_text(<span class="stringliteral">&quot;/&quot;</span>);
            print_mstr(<a class="code" href="group__g__file.html#gac2e9e12274b96e406fcbe59203338d2c" title="Return the name of the given file.">OCI_FileGetName</a>(file));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
            i++;
        }

        rs = <a class="code" href="group__g__ora__ret.html#ga67cbb956e8d721c8397e3f897a57b224" title="Retrieve the next resultset from an executed DML statement using a &#39;SQL returning&#39; clause...">OCI_GetNextResultset</a>(st);
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_object_insert</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_object_insert(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a> *date;
    <a class="code" href="struct_o_c_i___file.html" title="Oracle External Large objects:">OCI_File</a> *file;
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a>  *lob;
    <a class="code" href="struct_o_c_i___object.html" title="Oracle Named types representation.">OCI_Object</a> *obj;
    <a class="code" href="struct_o_c_i___object.html" title="Oracle Named types representation.">OCI_Object</a> *obj2;

    <span class="keywordtype">char</span> rawbuf[11];

    strcpy(rawbuf, <span class="stringliteral">&quot;0123456789&quot;</span>);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST OBJECT BINDING \n\n&quot;</span>);

    <span class="comment">/* create types for the demo */</span>

    obj  = <a class="code" href="group__g__usertypes.html#ga5e8f1db675e2b4fe74c82bdc79be8294" title="Create a local object instance.">OCI_ObjectCreate</a>(cn, <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;test_t&quot;</span>), OCI_TIF_TYPE));

    <a class="code" href="group__g__usertypes.html#ga147c7a4197929f725aabe4bfb4e42a52" title="Set an object attribute of type int.">OCI_ObjectSetInt</a>(obj, MT(<span class="stringliteral">&quot;VAL_INT&quot;</span>), 1);
    <a class="code" href="group__g__usertypes.html#gabdd2fa4bd5d4b019087d8a9aa9e21a2a" title="Set an object attribute of type double.">OCI_ObjectSetDouble</a>(obj, MT(<span class="stringliteral">&quot;VAL_FLT&quot;</span>), 3.14);
    <a class="code" href="group__g__usertypes.html#ga93eb03a281c7a798bc804eb4a3496799" title="Set an object attribute of type string.">OCI_ObjectSetString</a>(obj, MT(<span class="stringliteral">&quot;VAL_STR&quot;</span>), DT(<span class="stringliteral">&quot;USB KEY 2go&quot;</span>));
    <a class="code" href="group__g__usertypes.html#gae96ad3c3dadc651a7f9f65b2ce0088fb" title="Set an object attribute of type RAW.">OCI_ObjectSetRaw</a>(obj, MT(<span class="stringliteral">&quot;VAL_RAW&quot;</span>), rawbuf, 10);

    date = <a class="code" href="group__g__date.html#gae80eacef54641a68c3b82be85f4a5042" title="Create a local date object.">OCI_DateCreate</a>(cn);
    <a class="code" href="group__g__date.html#gad7c5c65d88b52e6ecb46b3e9ba8843dc" title="Return the current system date/time into the date handle.">OCI_DateSysDate</a>(date);
    <a class="code" href="group__g__usertypes.html#ga90cd1ab17692711fcc4aa7791c981065" title="Set an object attribute of type Date.">OCI_ObjectSetDate</a>(obj, MT(<span class="stringliteral">&quot;VAL_DATE&quot;</span>), date);

    obj2 = <a class="code" href="group__g__usertypes.html#ga5e8f1db675e2b4fe74c82bdc79be8294" title="Create a local object instance.">OCI_ObjectCreate</a>(cn, <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;TYPE_T&quot;</span>), OCI_TIF_TYPE));
    <a class="code" href="group__g__usertypes.html#ga147c7a4197929f725aabe4bfb4e42a52" title="Set an object attribute of type int.">OCI_ObjectSetInt</a>(obj2, MT(<span class="stringliteral">&quot;ID&quot;</span>), 1);

    <a class="code" href="group__g__usertypes.html#ga93eb03a281c7a798bc804eb4a3496799" title="Set an object attribute of type string.">OCI_ObjectSetString</a>(obj2, MT(<span class="stringliteral">&quot;NAME&quot;</span>), DT(<span class="stringliteral">&quot;USB KEY 2go&quot;</span>));
    <a class="code" href="group__g__usertypes.html#ga874ad68cde4b8bcbaacb9056f97896d9" title="Set an object attribute of type Object.">OCI_ObjectSetObject</a>(obj, MT(<span class="stringliteral">&quot;VAL_OBJ&quot;</span>), obj2);

    lob = <a class="code" href="group__g__lob.html#ga318f1273603e24b51c3d9e4c29f42685" title="Create a local temporary Lob instance.">OCI_LobCreate</a>(cn, OCI_CLOB);
    <a class="code" href="group__g__usertypes.html#ga7abece098177ff2a88c3e24a6cbdacb9" title="Set an object attribute of type Lob.">OCI_ObjectSetLob</a>(obj, MT(<span class="stringliteral">&quot;VAL_LOB&quot;</span>), lob);

    file = <a class="code" href="group__g__file.html#ga199d6ce1a1231feb56b456ad6cbc2714" title="Create a file object instance.">OCI_FileCreate</a>(cn, OCI_BFILE);
    <a class="code" href="group__g__file.html#gae31e36e786faf43a2663806a28814c68" title="Set the directory and file name of FILE handle.">OCI_FileSetName</a>(file, MT(<span class="stringliteral">&quot;mydir&quot;</span>), MT(<span class="stringliteral">&quot;myfile&quot;</span>));
    <a class="code" href="group__g__usertypes.html#ga12af1c0268b98bd3f699390f9a0777a3" title="Set an object attribute of type File.">OCI_ObjectSetFile</a>(obj, MT(<span class="stringliteral">&quot;VAL_FILE&quot;</span>), file);

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;insert into test_object values(:obj)&quot;</span>));
    <a class="code" href="group__g__bind.html#ga91d068da1fbd27e81160588e08062940" title="Bind an object (named type) variable.">OCI_BindObject</a>(st, MT(<span class="stringliteral">&quot;:obj&quot;</span>), obj);
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    print_frmt(<span class="stringliteral">&quot;\n%d row(s) inserted\n&quot;</span>, <a class="code" href="group__g__exec.html#ga1cf932261960da80cd36d650a08565c3" title="Return the number of rows affected by the SQL statement.">OCI_GetAffectedRows</a>(st));

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);

    <a class="code" href="group__g__date.html#gaedf77cfe4bd5dab7909e4c2fb5173b48" title="Free a date object.">OCI_DateFree</a>(date);
    <a class="code" href="group__g__lob.html#gaac269a3de312c2c7d1a6193a9ab79545" title="Free a local temporary lob.">OCI_LobFree</a>(lob);
    <a class="code" href="group__g__file.html#gad4b58b6d80e24bb045fb82d78c5cf36a" title="Free a local File object.">OCI_FileFree</a>(file);
    <a class="code" href="group__g__usertypes.html#ga3fd2c9dfdcab2c56400c95c31cc0851e" title="Free a local object.">OCI_ObjectFree</a>(obj2);
    <a class="code" href="group__g__usertypes.html#ga3fd2c9dfdcab2c56400c95c31cc0851e" title="Free a local object.">OCI_ObjectFree</a>(obj);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_object_fetch</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_object_fetch(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___lob.html" title="Oracle Internal Large objects:">OCI_Lob</a> *lob;
    <a class="code" href="struct_o_c_i___date.html" title="Oracle internal date representation.">OCI_Date</a> *date;
    <a class="code" href="struct_o_c_i___file.html" title="Oracle External Large objects:">OCI_File</a> *file;
    <a class="code" href="struct_o_c_i___object.html" title="Oracle Named types representation.">OCI_Object</a> *obj;
    <a class="code" href="struct_o_c_i___object.html" title="Oracle Named types representation.">OCI_Object</a> *obj2;
    <span class="keywordtype">char</span> rawbuf[11] = <span class="stringliteral">&quot;&quot;</span>;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST OBJECT FETCHING \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select val from test_object for update&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="comment">/* print resultset content */</span>
    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        obj  = <a class="code" href="group__g__fetch.html#gabef5c4bbab7c79ce2fa9113d1a23a865" title="Return the current Object value of the column at the given index in the resultset.">OCI_GetObject</a>(rs, 1);

        print_frmt(<span class="stringliteral">&quot;val_int        : %i\n&quot;</span>,  <a class="code" href="group__g__usertypes.html#ga05bf984246cbaaa6d554af9cfb8d99e9" title="Return the integer value of the given object attribute.">OCI_ObjectGetInt</a>(obj, MT(<span class="stringliteral">&quot;VAL_INT&quot;</span>)));
        print_frmt(<span class="stringliteral">&quot;val_flt        : %g\n&quot;</span>,  <a class="code" href="group__g__usertypes.html#ga625c2fc05309303f698fd447f438d527" title="Return the double value of the given object attribute.">OCI_ObjectGetDouble</a>(obj, MT(<span class="stringliteral">&quot;VAL_FLT&quot;</span>)));
        print_text(<span class="stringliteral">&quot;val_str        : &quot;</span>); print_dstr(<a class="code" href="group__g__usertypes.html#ga95ba08a32cf97b7bed6235cc48bd2300" title="Return the string value of the given object attribute.">OCI_ObjectGetString</a>(obj, MT(<span class="stringliteral">&quot;VAL_STR&quot;</span>)));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        temp[<a class="code" href="group__g__usertypes.html#ga5f369b31baa374ac4c0d17d37e5f542a" title="Return the raw attribute value of the given object attribute into the given buffer.">OCI_ObjectGetRaw</a>(obj, MT(<span class="stringliteral">&quot;VAL_RAW&quot;</span>), rawbuf, 10)] = 0;
        print_text(<span class="stringliteral">&quot;val_raw        : &quot;</span>); printf(rawbuf);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        date = <a class="code" href="group__g__usertypes.html#ga482b6b2454951874790451be6bc810f7" title="Return the date value of the given object attribute.">OCI_ObjectGetDate</a>(obj, MT(<span class="stringliteral">&quot;VAL_DATE&quot;</span>));
        <a class="code" href="group__g__date.html#ga48334e86fc54a800a44f2c8e6759adfd" title="Convert a Date value from the given date handle to a string.">OCI_DateToText</a>(date, MT(<span class="stringliteral">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), SIZE_STR, str);
        print_text(<span class="stringliteral">&quot;val_date       : &quot;</span>); print_mstr(str);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        lob = <a class="code" href="group__g__usertypes.html#gae75646c8a8c994d2ebd83d992bc97c18" title="Return the lob value of the given object attribute.">OCI_ObjectGetLob</a>(obj, MT(<span class="stringliteral">&quot;VAL_LOB&quot;</span>));

        <a class="code" href="group__g__lob.html#ga949f7050609430486c9ef0f3c488d38a" title="[OBSOLETE] Write a buffer into a LOB">OCI_LobWrite</a>(lob, DT(<span class="stringliteral">&quot;Hello from Mars !&quot;</span>), 17);
        <a class="code" href="group__g__lob.html#ga63df7f944c418642fc04571a4a522b87" title="Perform a seek operation on the OCI_lob content buffer.">OCI_LobSeek</a>(lob, 0, OCI_SEEK_SET);

        temp[<a class="code" href="group__g__lob.html#ga36708313dc7d5c0b2c30f7f8b9fa2e2d" title="[OBSOLETE] Read a portion of a lob into the given buffer">OCI_LobRead</a>(lob, temp, SIZE_STR)]=0;

        print_text(<span class="stringliteral">&quot;val_lob        : &quot;</span>); print_dstr(temp);
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        file = <a class="code" href="group__g__usertypes.html#ga77da8639680cdc1f374efa80d6d389dc" title="Return the file value of the given object attribute.">OCI_ObjectGetFile</a>(obj, MT(<span class="stringliteral">&quot;VAL_FILE&quot;</span>));
        print_text(<span class="stringliteral">&quot;val_file.dir   : &quot;</span>); print_mstr(<a class="code" href="group__g__file.html#ga920ae6408404696e2c76cfc73a568136" title="Return the directory of the given file.">OCI_FileGetDirectory</a>(file));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        print_text(<span class="stringliteral">&quot;val_file.name  : &quot;</span>); print_mstr(<a class="code" href="group__g__file.html#gac2e9e12274b96e406fcbe59203338d2c" title="Return the name of the given file.">OCI_FileGetName</a>(file));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        obj2 = <a class="code" href="group__g__usertypes.html#ga89378768a57c72154e464a99a20ac5ae" title="Return the object value of the given object attribute.">OCI_ObjectGetObject</a>(obj, MT(<span class="stringliteral">&quot;VAL_OBJ&quot;</span>));
        print_frmt(<span class="stringliteral">&quot;val_obj.code   : %i\n&quot;</span>, <a class="code" href="group__g__usertypes.html#ga05bf984246cbaaa6d554af9cfb8d99e9" title="Return the integer value of the given object attribute.">OCI_ObjectGetInt</a>(obj2, MT(<span class="stringliteral">&quot;ID&quot;</span>)));
        print_text(<span class="stringliteral">&quot;val_obj.name   : &quot;</span>); print_dstr(<a class="code" href="group__g__usertypes.html#ga95ba08a32cf97b7bed6235cc48bd2300" title="Return the string value of the given object attribute.">OCI_ObjectGetString</a>(obj2, MT(<span class="stringliteral">&quot;NAME&quot;</span>)));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        printf(<span class="stringliteral">&quot;\n&quot;</span>);;

    }

    <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_scrollable_cursor</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_scrollable_cursor(<span class="keywordtype">void</span>)
{
    <span class="keywordflow">if</span> (<a class="code" href="group__g__connect.html#ga6f61147801fce4b69edb4981ba4ea1b7" title="Return the highest Oracle version is supported by the connection.">OCI_GetVersionConnection</a>(cn) &gt;= OCI_9_0)
    {
        print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST SCROLLABLE CURSORS \n\n&quot;</span>);

        <a class="code" href="group__g__stmt.html#ga83e1c31e40926a84651eb60fefd50d5e" title="Set the fetch mode of a SQL statement.">OCI_SetFetchMode</a>(st, OCI_SFM_SCROLLABLE);

        <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select table_name from user_tables where &quot;</span>)
                            MT(<span class="stringliteral">&quot;table_name like &#39;TEST_%&#39; order by table_name&quot;</span>));

        rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

        <span class="keywordflow">if</span> (<a class="code" href="group__g__fetch.html#gab2b3f30ace2a89b07dd7803c82a523e7" title="Fetch the last row of the resultset.">OCI_FetchLast</a>(rs))
            print_frmt(<span class="stringliteral">&quot;... Resultset contains %i rows\n\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));

        print_text(<span class="stringliteral">&quot;... Go to row 1\n&quot;</span>);
        <span class="keywordflow">if</span> (<a class="code" href="group__g__fetch.html#gaf26bde3f9db77231d66107af24a51d96" title="Fetch the first row of the resultset.">OCI_FetchFirst</a>(rs))
        {
            print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }

        print_frmt(<span class="stringliteral">&quot;... Enumerate from row 2 to row %i\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs));
        <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
        {
            print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }

        print_frmt(<span class="stringliteral">&quot;... Enumerate from row %i back to row 1\n&quot;</span>, <a class="code" href="group__g__fetch.html#ga93bd9197720088dbda2bef593ad1c07c" title="Retrieve the number of rows fetched so far.">OCI_GetRowCount</a>(rs)-1);
        <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga81e501b509b84d999e4337e2e11a90ec" title="Fetch the previous row of the resultset.">OCI_FetchPrev</a>(rs))
        {
            print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }

        print_text(<span class="stringliteral">&quot;... Go to the 3th row\n&quot;</span>);
        <span class="keywordflow">if</span> (<a class="code" href="group__g__fetch.html#ga99372dc21a4965ca74d8fdde2069cc10" title="Custom Fetch of the resultset.">OCI_FetchSeek</a>(rs, OCI_SFD_ABSOLUTE,  3))
        {
            print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }

        print_text(<span class="stringliteral">&quot;... Fetch the next 2 rows\n&quot;</span>);
        <span class="keywordflow">while</span> ((<a class="code" href="group__g__fetch.html#ga4add0a9c53a23b334197c655b46b620c" title="Retrieve the current row number.">OCI_GetCurrentRow</a>(rs) &lt; 5) &amp;&amp; <a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
        {
            print_dstr(<a class="code" href="group__g__fetch.html#ga755a9b07c174feacd05c86e0e44b0ab0" title="Return the current string value of the column at the given index in the resultset.">OCI_GetString</a>(rs, 1));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);
        }

        <a class="code" href="group__g__stmt.html#ga83e1c31e40926a84651eb60fefd50d5e" title="Set the fetch mode of a SQL statement.">OCI_SetFetchMode</a>(st, OCI_SFM_DEFAULT);
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_collection</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_collection(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___type_info.html" title="Type info metadata handle.">OCI_TypeInfo</a> *type;
    <a class="code" href="struct_o_c_i___coll.html" title="Oracle Collections (VARRAYs and Nested Tables) representation.">OCI_Coll</a>     *coll;
    <a class="code" href="struct_o_c_i___iter.html" title="Oracle Collection iterator representation.">OCI_Iter</a>     *iter;
    <a class="code" href="struct_o_c_i___elem.html" title="Oracle Collection item representation.">OCI_Elem</a>     *elem;
    <span class="keywordtype">int</span> i, n;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST VARRAY BINDING \n\n&quot;</span>);

    type = <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;T_TAB1_EMP&quot;</span>), OCI_TIF_TYPE);
    coll = <a class="code" href="group__g__collection.html#gaa2c5c18fa416fe1f955ccb5dbff43046" title="Create a local collection instance.">OCI_CollCreate</a>(type);

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;begin&quot;</span>)
                    MT(<span class="stringliteral">&quot;    select employees into :tab_emp &quot;</span>)
                    MT(<span class="stringliteral">&quot;    from test_coll_varray &quot;</span>)
                    MT(<span class="stringliteral">&quot;    where departement = :id; &quot;</span>)
                    MT(<span class="stringliteral">&quot;end;&quot;</span>));

    <a class="code" href="group__g__bind.html#ga9399dea6317fcd8d5c6d5b6282ec0d7b" title="Bind a Collection variable.">OCI_BindColl</a>(st, MT(<span class="stringliteral">&quot;:tab_emp&quot;</span>), coll);
    <a class="code" href="group__g__bind.html#ga4d08024d2242b6140fecea8c2ec05c81" title="Bind an integer variable.">OCI_BindInt</a>(st, MT(<span class="stringliteral">&quot;:id&quot;</span>), &amp;i);

    i = 1;

    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    iter = <a class="code" href="group__g__collection.html#ga22abd2fab4b93cceda5de975574d1b6e" title="Create an iterator handle to iterate through a collection.">OCI_IterCreate</a>(coll);
    elem = <a class="code" href="group__g__collection.html#gadfd202892038306f96b043d06e795133" title="Get the next element in the collection.">OCI_IterGetNext</a>(iter);

    print_frmt(<span class="stringliteral">&quot;Department ID #%d\n\n&quot;</span>, i);

    <span class="keywordflow">while</span> (elem != NULL)
    {
        print_text(<span class="stringliteral">&quot;... Employee : &quot;</span>);
        print_dstr(<a class="code" href="group__g__collection.html#ga3f37f83b33c65908812643ef68f31db1" title="Return the String value of the given collection element.">OCI_ElemGetString</a>(elem));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        elem = <a class="code" href="group__g__collection.html#gadfd202892038306f96b043d06e795133" title="Get the next element in the collection.">OCI_IterGetNext</a>(iter);
    }

    <a class="code" href="group__g__collection.html#ga9b186234fa7bfd143e2fecb126c7a8a4" title="Free an iterator handle.">OCI_IterFree</a>(iter);
    <a class="code" href="group__g__collection.html#ga8663babe980c99ff0441feedff973912" title="Free a local collection.">OCI_CollFree</a>(coll);

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST VARRAY FETCHING WITH ITERATOR \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;SELECT * from test_coll_varray&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        coll = <a class="code" href="group__g__fetch.html#gaef57431fc441f687418f6fedd341ce5a" title="Return the current Collection value of the column at the given index in the resultset.">OCI_GetColl</a>(rs, 2);

        iter = <a class="code" href="group__g__collection.html#ga22abd2fab4b93cceda5de975574d1b6e" title="Create an iterator handle to iterate through a collection.">OCI_IterCreate</a>(coll);
        elem = <a class="code" href="group__g__collection.html#gadfd202892038306f96b043d06e795133" title="Get the next element in the collection.">OCI_IterGetNext</a>(iter);

        print_frmt(<span class="stringliteral">&quot;\nDepartment ID #%d\n\n&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));

        <span class="keywordflow">while</span> (elem != NULL)
        {
            print_text(<span class="stringliteral">&quot;... Employee : &quot;</span>);
            print_dstr(<a class="code" href="group__g__collection.html#ga3f37f83b33c65908812643ef68f31db1" title="Return the String value of the given collection element.">OCI_ElemGetString</a>(elem));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

            elem = <a class="code" href="group__g__collection.html#gadfd202892038306f96b043d06e795133" title="Get the next element in the collection.">OCI_IterGetNext</a>(iter);
        }

        <a class="code" href="group__g__collection.html#ga9b186234fa7bfd143e2fecb126c7a8a4" title="Free an iterator handle.">OCI_IterFree</a>(iter);
    }


    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST NESTED TABLE FETCHING WITH INDEX ACCESS \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;SELECT * from test_coll_nested&quot;</span>));

    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        coll = <a class="code" href="group__g__fetch.html#gaef57431fc441f687418f6fedd341ce5a" title="Return the current Collection value of the column at the given index in the resultset.">OCI_GetColl</a>(rs, 2);

        print_frmt(<span class="stringliteral">&quot;\nDepartment ID #%d\n\n&quot;</span>, <a class="code" href="group__g__fetch.html#gaa8d80dc30b2012eaddd13efa9dfb711d" title="Return the current integer value of the column at the given index in the resultset.">OCI_GetInt</a>(rs, 1));

        n = <a class="code" href="group__g__collection.html#ga450564910d9447ce525e76880728d2aa" title="Returns the current number of elements of the given collection.">OCI_CollGetSize</a>(coll);

        <span class="keywordflow">for</span>(i = 1; i &lt;= n; i++)
        {
            elem = <a class="code" href="group__g__collection.html#ga65523dc5e889b8d1e956674dd05e9b8b" title="Return the element at the given position in the collection.">OCI_CollGetAt</a>(coll, i);

            print_text(<span class="stringliteral">&quot;... Employee : &quot;</span>);
            print_dstr(<a class="code" href="group__g__collection.html#ga3f37f83b33c65908812643ef68f31db1" title="Return the String value of the given collection element.">OCI_ElemGetString</a>(elem));
            print_text(<span class="stringliteral">&quot;\n&quot;</span>);

        }
    }
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_ref</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_ref(<span class="keywordtype">void</span>)
{
    <a class="code" href="struct_o_c_i___ref.html" title="Oracle REF type representation.">OCI_Ref</a>    *ref;
    <a class="code" href="struct_o_c_i___object.html" title="Oracle Named types representation.">OCI_Object</a> *obj;

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST REF FETCHING \n\n&quot;</span>);

    <a class="code" href="group__g__exec.html#gaf2163ec44e644cc734c393188707985b" title="Execute a SQL statement or PL/SQL block.">OCI_ExecuteStmt</a>(st, MT(<span class="stringliteral">&quot;select ref(e) from test_table_obj e&quot;</span>));
    rs = <a class="code" href="group__g__fetch.html#gaf2a9e28b66a9538ba0ffb62bffb87c16" title="Retrieve the resultset handle from an executed statement.">OCI_GetResultset</a>(st);

    <span class="keywordflow">while</span> (<a class="code" href="group__g__fetch.html#ga36ac26dcea78f6074421781e401f97ba" title="Fetch the next row of the resultset.">OCI_FetchNext</a>(rs))
    {
        ref = <a class="code" href="group__g__fetch.html#gaa9376300d7b7a383e98cacb809677a5d" title="Return the current Ref value of the column at the given index in the resultset.">OCI_GetRef</a>(rs, 1);

        obj = <a class="code" href="group__g__usertypes.html#gae101916e55785052645366228f3a8751" title="Returns the object pointed by the Ref handle.">OCI_RefGetObject</a>(ref);

        print_frmt(<span class="stringliteral">&quot;%i - &quot;</span>, <a class="code" href="group__g__usertypes.html#ga05bf984246cbaaa6d554af9cfb8d99e9" title="Return the integer value of the given object attribute.">OCI_ObjectGetInt</a>(obj, MT(<span class="stringliteral">&quot;ID&quot;</span>)));
        print_dstr(<a class="code" href="group__g__usertypes.html#ga95ba08a32cf97b7bed6235cc48bd2300" title="Return the string value of the given object attribute.">OCI_ObjectGetString</a>(obj, MT(<span class="stringliteral">&quot;NAME&quot;</span>)));
        print_text(<span class="stringliteral">&quot;\n&quot;</span>);
    }

    print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST REF PL/SQL BINDING \n\n&quot;</span>);

    ref = <a class="code" href="group__g__usertypes.html#gadd765dc3c5ebe2f3472c4fc2760e9b29" title="Create a local Ref instance.">OCI_RefCreate</a>(cn, <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;type_t&quot;</span>), OCI_TIF_TYPE));

    <a class="code" href="group__g__exec.html#gad5a7fcffe7d24da001e44636cfc06578" title="Prepare a SQL statement or PL/SQL block.">OCI_Prepare</a>(st, MT(<span class="stringliteral">&quot;begin &quot;</span>)
                    MT(<span class="stringliteral">&quot;  select ref(e) into :r from test_table_obj e where e.id = 1; &quot;</span>)
                    MT(<span class="stringliteral">&quot;end; &quot;</span>));

    <a class="code" href="group__g__bind.html#ga6e0a9dbf317ed5a28e122efad364d3ab" title="Bind a Ref variable.">OCI_BindRef</a>(st, MT(<span class="stringliteral">&quot;:r&quot;</span>), ref);
    <a class="code" href="group__g__exec.html#ga7189aa353845909aaedc8d5956429450" title="Execute a prepared SQL statement or PL/SQL block.">OCI_Execute</a>(st);

    obj = <a class="code" href="group__g__usertypes.html#gae101916e55785052645366228f3a8751" title="Returns the object pointed by the Ref handle.">OCI_RefGetObject</a>(ref);
    print_frmt(<span class="stringliteral">&quot;%i - &quot;</span>, <a class="code" href="group__g__usertypes.html#ga05bf984246cbaaa6d554af9cfb8d99e9" title="Return the integer value of the given object attribute.">OCI_ObjectGetInt</a>(obj, MT(<span class="stringliteral">&quot;ID&quot;</span>)));
    print_dstr(<a class="code" href="group__g__usertypes.html#ga95ba08a32cf97b7bed6235cc48bd2300" title="Return the string value of the given object attribute.">OCI_ObjectGetString</a>(obj, MT(<span class="stringliteral">&quot;NAME&quot;</span>)));
    print_text(<span class="stringliteral">&quot;\n&quot;</span>);

    <a class="code" href="group__g__usertypes.html#ga4d38338b68e78fbf2be15a9fc7a01b46" title="Free a local Ref.">OCI_RefFree</a>(ref);
}

<span class="comment">/* ------------------------------------------------------------------------ *</span>
<span class="comment"> * test_directpath</span>
<span class="comment"> * ------------------------------------------------------------------------ */</span>

<span class="keywordtype">void</span> test_directpath(<span class="keywordtype">void</span>)
{
   <span class="comment">/* Some OCI Direct path function fails (segfault) if the OCI version of the</span>
<span class="comment">      client is different than the server one.</span>
<span class="comment">      It happens with OCI 8i and 9i client. Apparently Oracle 10g and 11g seems to</span>
<span class="comment">      have fixed these problems.</span>
<span class="comment">      Anyway, we run this test case only if the major versions of client and server</span>
<span class="comment">      match</span>
<span class="comment">   */</span>

   <span class="keywordflow">if</span> (OCI_VER_MAJ(<a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>()) == <a class="code" href="group__g__connect.html#ga2d7618d8eae73643dd75067a40e656a1" title="Return the major version number of the connected database server.">OCI_GetServerMajorVersion</a>(cn))
   {
        <a class="code" href="struct_o_c_i___dir_path.html" title="OCILIB encapsulation of OCI Direct Path handle.">OCI_DirPath</a> *dp;
        <a class="code" href="struct_o_c_i___type_info.html" title="Type info metadata handle.">OCI_TypeInfo</a> *tbl;
        <span class="keywordtype">boolean</span> res = TRUE;

        dtext val1[SIZE_COL1+1];
        dtext val2[SIZE_COL2+1];
        dtext val3[SIZE_COL3+1];

        <span class="keywordtype">int</span> i = 0, j = 0, nb_rows = SIZE_ARRAY;
        <span class="keywordtype">int</span> state;

       <span class="comment">/* commit any previous pending modifications */</span>

        <a class="code" href="group__g__transac.html#gaee1ba614ed2dc5bd83bf788ca08f3e71" title="Commit current pending changes.">OCI_Commit</a>(cn);

        print_text(<span class="stringliteral">&quot;\n&gt;&gt;&gt;&gt;&gt; TEST DIRECT PATH (10 loads of 100 rows) \n\n&quot;</span>);

        tbl = <a class="code" href="group__g__desc.html#ga4990c22d2773746a0ab61ec95470445c" title="Retrieve the available type info information.">OCI_TypeInfoGet</a>(cn, MT(<span class="stringliteral">&quot;test_directpath&quot;</span>), OCI_TIF_TABLE);
        dp  = <a class="code" href="group__g__dirpath.html#gaba1bc1525b29dc95896cafe9a97c8197" title="Create a direct path object.">OCI_DirPathCreate</a>(tbl, NULL, NUM_COLS, nb_rows);

        <span class="comment">/* optional attributes to set */</span>

        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gae25febeb9086f1604743fbf54a4cf677" title="Set the size of the internal stream transfer buffer.">OCI_DirPathSetBufferSize</a>(dp, 64000);
        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#ga59a031e1515afd31654105071dc7e371" title="Set the logging mode for the loading operation.">OCI_DirPathSetNoLog</a>(dp, TRUE);
        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gafab72b4c04bd2c5d3c850f58f5b22fd2" title="Set the parallel loading mode.">OCI_DirPathSetParallel</a>(dp, TRUE);

        <span class="keywordflow">if</span>(<a class="code" href="group__g__init.html#ga771bf5d33dbd0b63d84242819209b35b" title="Return the version of OCI used at runtime.">OCI_GetOCIRuntimeVersion</a>() &gt;= OCI_9_2)
        {
            res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gaa0976d38ccf4d6f09657115ad6e47880" title="Set number of elements in the date cache.">OCI_DirPathSetCacheSize</a>(dp, 100);
        }

        <span class="comment">/* describe the target table */</span>

        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gae32abffa49b03c829f6087e8616dc2b3" title="Describe a column to load into the given table.">OCI_DirPathSetColumn</a>(dp, 1, MT(<span class="stringliteral">&quot;VAL_INT&quot;</span>),  SIZE_COL1, NULL);
        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gae32abffa49b03c829f6087e8616dc2b3" title="Describe a column to load into the given table.">OCI_DirPathSetColumn</a>(dp, 2, MT(<span class="stringliteral">&quot;VAL_STR&quot;</span>),  SIZE_COL2, NULL);
        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gae32abffa49b03c829f6087e8616dc2b3" title="Describe a column to load into the given table.">OCI_DirPathSetColumn</a>(dp, 3, MT(<span class="stringliteral">&quot;VAL_DATE&quot;</span>), SIZE_COL3, MT(<span class="stringliteral">&quot;YYYYMMDD&quot;</span>));

        <span class="comment">/* prepare the load */</span>

        res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#ga31aae5239710847d43b90166fedf0419" title="Prepares the OCI direct path load interface before any rows can be converted or loaded.">OCI_DirPathPrepare</a>(dp);

        <span class="keywordflow">if</span> (res)
        {
            nb_rows = <a class="code" href="group__g__dirpath.html#ga2ff812128f1604615f186aa8bdf8269d" title="Return the maximum number of rows allocated in the OCI and OCILIB internal arrays of rows...">OCI_DirPathGetMaxRows</a>(dp);          
            
            <span class="keywordflow">for</span> (i = 0; i &lt; NB_LOAD ; i++)
            {
                <a class="code" href="group__g__dirpath.html#ga2efc984ff0647d3a3c4b29f7e9ec37e2" title="Reset internal arrays and streams to prepare another load.">OCI_DirPathReset</a>(dp);

                <span class="keywordflow">for</span> (j = 1; j &lt;= nb_rows &amp;&amp; res; j++)
                {
                    <span class="comment">/* fill test values */</span>

                    sprint_dt(val1, SIZE_COL1+1, DT(<span class="stringliteral">&quot;%04d&quot;</span>), i + (i*100));
                    sprint_dt(val2, SIZE_COL2+1, DT(<span class="stringliteral">&quot;value %05d&quot;</span>), j + (i*100));
                    sprint_dt(val3, SIZE_COL3+1, DT(<span class="stringliteral">&quot;%04d%02d%02d&quot;</span>), (j%23)+1 + 2000,
                                                                     (j%11)+1,
                                                                     (j%23)+1);

                    res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gaaadd5e79891c24d0f9c99ed96e5fe608" title="Set the value of the given row/column array entry.">OCI_DirPathSetEntry</a>(dp, j, 1, val1, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) dtslen(val1), TRUE);
                    res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gaaadd5e79891c24d0f9c99ed96e5fe608" title="Set the value of the given row/column array entry.">OCI_DirPathSetEntry</a>(dp, j, 2, val2, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) dtslen(val2), TRUE);
                    res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#gaaadd5e79891c24d0f9c99ed96e5fe608" title="Set the value of the given row/column array entry.">OCI_DirPathSetEntry</a>(dp, j, 3, val3, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) dtslen(val3), TRUE);
                }

               <span class="comment">/* load data to the server */</span>

                <span class="keywordflow">while</span> (res == TRUE)
                {
                    state = <a class="code" href="group__g__dirpath.html#ga8dd680e9664028af035e773275e5ab76" title="Convert user provided data to a direct path stream format.">OCI_DirPathConvert</a>(dp);

                    <span class="keywordflow">if</span> ((state == OCI_DPR_FULL) || (state == OCI_DPR_COMPLETE))
                        res = <a class="code" href="group__g__dirpath.html#ga0c816466d046a3d8c179f779e273f456" title="Loads the data converted to direct path stream format.">OCI_DirPathLoad</a>(dp);

                    <span class="keywordflow">if</span> (state == OCI_DPR_COMPLETE)
                        <span class="keywordflow">break</span>;
                }
            }

            <span class="comment">/* commits changes */</span>

            res = res &amp;&amp; <a class="code" href="group__g__dirpath.html#ga7c80a8db7ef79e4693ac0e770bb2018f" title="Terminate a direct path operation and commit changes into the database.">OCI_DirPathFinish</a>(dp);

            <span class="keywordflow">if</span> (res)
            {
                print_frmt(<span class="stringliteral">&quot;%04d row(s) loaded\n&quot;</span>, <a class="code" href="group__g__dirpath.html#gaffb07d43825826b0c9af060ee52fc3e0" title="Return the number of rows successfully loaded into the database so far.">OCI_DirPathGetRowCount</a>(dp));
            }

            <span class="comment">/* free direct path object */</span>
        }

        <a class="code" href="group__g__dirpath.html#ga024f04e69293349e3882b2f367a03ed6" title="Free an OCI_DirPath handle.">OCI_DirPathFree</a>(dp);
   }
}

</pre></div> <table class="memberdecls">
</table>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sun Dec 4 2011 15:41:34 for OCILIB (C Driver for Oracle) by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
